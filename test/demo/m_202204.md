
# 202105

------------------------------

## 20210517 Mon

*Citrix*
http://10.5.128.34/Citrix/DXHDEVWeb/
** A0153017 PassWord1! **
jack.huang@finastra.com

** CD210357 5tgb<KI* 考勤机编号：5902  **

CD210357(黄文荣）（密码 1qaz@WSX）；考勤机编号：5902

1是安装Citrix ；2是卸载Citrix
http://10.5.128.34/Citrix/DXHDEVWeb/1.exe
http://10.5.128.34/Citrix/DXHDEVWeb/2.exe

itmis : 10.5.2.83:8099   CD210357 5tgb<KI*   CDB 1qaz@4321 



内网机
JiWangNei@345  
IT维护 ： 88888 阜外5014室   3664 SVN运维团队
svn: http://svndev.cdb.com.cn/svn/FTUS/src/FTUS/trunk/v5.6.x/
SUMMIR , PAL , FTUS , HKTC :  CD180027 , 180027@LDPcdb


序号	IP地址（新服务器）	远程登录密码（远程登录用户名为：Administrator）	IP地址	远程登录密码（远程登录用户名为：Administrator）	DB连接信息	数据库服务器	备注	SMT/DBNAME	WAS	"WAS
(155网段）"

自贸区开发环境  	10.5.155.236	Ficdb@Ho155210   --	10.5.91.60	Ficdb@Ftus9160	OSUM137	10.5.146.32(x小机) oracle/oracle	自贸区开发编译环境	"smt/Smt_9160
cdbftus/Cdbftus_9160
config: smt"	wasadmin/Wasadmin123!	was_4321

Finastra-Guest：guest@ccess12  ， Welcome1 ， Password1，


10.5.156.1 Cdbho@56
10.5.156.3 Cdbftus@56
10.5.156.4 Cdbhk@56
10.5.156.5 Cdbrfr@62





------------------------------

## 20210525 Tue


etk ft
cd %SUMMITERRDIR%
etkservice.exe -N eTKS_ETKPoolService.axis2@localhost@8080#webtest#OSUM#Administrator_sumtrain#summit#171224211335700_3 -LOGGER DEBUG -TO 60000 -PR 10000:20000 -UTF


------------------------------

## 20210526 Wed

January, Februray, March, April, May, June,
July, August, September, October, November, December
Monday 月, Tuesday 火, Wednesday 水, Thursday 木, Friday 金, Saturday 土, Sunday 日



------------------------------

## 20210527 Thu

C++ 编译版本
printf（“%ld\n”, __cplusplus);

Oracle 版本查看及版本号说明

select * from v$version;
或select banner from sys.v_$version;
 结果如下：
    BANNER
 1 Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod
 2 PL/SQL Release 10.2.0.1.0 - Production
 3 CORE 10.2.0.1.0 Production
 4 TNS for 32-bit Windows: Version 10.2.0.1.0 - Production
 5 NLSRTL Version 10.2.0.1.0 - Production
 
 例如：Oracle 9.0.1.1.2 
 　　
 　　9：版本号 
 　　0：新特性版本号 
 　　1（第一个）：维护版本号 
 　　1（第二个）：普通的补丁设置号码 
 　　2：非凡的平台补丁设置号码
 
 
 
 = C:\sumapps\tools
 
 PATH and add D:\sumapps\tools\Cygwin\bin\ in the last
•	Add below environment variables to System variables.
o	CYGWIN= nodosfilewarning
o	HOME= D:\sumapps\tools\Cygwin\home\
o	SHELL= D:\sumapps\tools\Cygwin\bin\sh.exe
o	SHELLOPTS = igncr 

 
  当前安排有3个任务（优先级排序）：
1. 整理比对合并自贸区各个项目增量(2017-2020)的代码，周四可以评估出完成时间；
2. summit6.2.14 安装文档；  
3. ZeroCurve Interface 项目；
  

查看summit license
CD C:\sumapps\tools\elsServer\els\bin\win
C:\sumapps\tools\elsServer\els\bin\win>elskey.exe


elskey for ELS 5.0 - Finastra
HOSTNAME  : vmsumv62
SYSTEM KEY: fcdecc559c5d95eb630497e3113932644b43c77882e4e8c4af7020e84002c83e



------------------------------

## 20210528

自贸区代码整理（共21个项目）：
1. 昨天下午已初步比对了5个项目（2个涉及代码变更，3个不涉及代码/仅部署/测试），初步比对（第2步，与FTUS 自贸区环境中trunkb比对， 下一步仍需与开发环境/生产环境代码代码比对/合并）；
2. 部分结果，已记录在 自贸区代码合并说明 表， 昨天下班前已更新至svn;
 
交易日、起息日、计息日、估值日、结息日、到期日/提前到到期日

Summit_V6.0.21  
windows login : Administrator/Singapore1
DB login : system/oracle

SMT
User : smt
Password : smt
Server : [OSUM] localhost:1521, Oracle
Database : SMT
Bootstrap : http://localhost:8080/SMT/control

Summit Login : summit/hisummit, summit2/hisummit2

VM设置启动时设置固定日期
修改Windows XP Professional.vmx文件 
修改参数 Summit_V6.0_win64.vmx。
tools.syncTime = "FALSE"
增加参数 1514131200
time.synchronize.continue = "FALSE"
time.synchronize.restore = "FALSE"
time.synchronize.resume.disk = "FALSE"
time.synchronize.shrink = "FALSE"
time.synchronize.tools.startup = "FALSE"
rtc.startTime = 1514111200     
设置VM直接进BISO 2017-12-25 00:00:00
bios.forceSetupOnce = "TRUE"

2017-12-24 18:26:40 1514111200
2021-6-23   1624377600

sudo apt update 
sudo apt upgrade

------------------------------

## 20210530

电话：01085770641
城市：北京
名称：北京高碑店社区卫生服务中心-预防接种门诊
地址：北京市朝阳区高碑店村250号


16:52 05/30/2021

高碑店地区办事处卫生服务中心 
接种地址：北京市朝阳区高碑店乡惠河南街高碑店村250号 
咨询电话：(010)85775004,(010)85758396,(010)85757762

ftp服务: 关闭防火墙firewall 专用网络 private network




------------------------------

## 20210531

hi, I've sent an email(License_request_internal), please check and deal with it , Thanks 


序号	1
IP地址（新服务器）	10.5.155.236
远程登录密码（远程登录用户名为：Administrator）	Ficdb@Ho155210
IP地址	10.5.91.60
远程登录密码（远程登录用户名为：Administrator）	Ficdb@Ftus9160
DB连接信息	OSUM137
数据库服务器	10.5.146.32(x小机) oracle/oracle
备注	自贸区开发编译环境
SMT/DBNAME	"smt/Smt_9160
cdbftus/Cdbftus_9160
config: smt"
WAS	wasadmin/Wasadmin123!
"WAS
(155网段）"	was_4321

// 查看MD5值 certutil.exe -hashfile '.\XXXXXX.rar' MD5 

Control Panel\All Control Panel Items  控制面板
Control
Control Panel\Network and Internet\Network Connections  网络设备、端口设置

mstsc 远程 
dxdiag  诊断，系统信息
devmgmt.msc  设备管理器

www2.summitsupport.com\rngt\Notes.aspx

svn:  http://svndev.cdb.com.cn/svn
中行：svn/SUMMIT
自贸区：svn/FTUS
港行：svn/HKTC

.svndev2.

svndev : 用CD180027/180027@LDPcdb

### 删除.svn文件夹

```cmd
@echo off

for /f %%i in ('dir %cd% /s/b/a:d')  do ( 
	echo %%i 
	echo %%i|findstr ".svn" >nul && (if exist %%i (rd /s /q %%i ) )
)

echo.
echo.
for /f %%i in ('dir %cd% /s/b/a:d')  do ( echo %%i )

pause
```

------------------------------

# 202106



------------------------------

## 20210601

timesheet: 
Time & Expense Entry 


批量verify继续实施涉及的工作：
1.  CFETS Java client端改造, （接入交易要素、清算路径等）；与CFETS 联调测试 
-- 前提: CFETS现有接口已提供所需的交易要素及清算路径 ； 预估 10 mds
2.  分析交易后处理（K 实施，已上线）与 批量verify是否存在需要合并的情况（交易后处理 已实现一个Trade Server；批量verify也需要Trade Server) ; 目前看，暂不需要，需进一步分析；预估 1md
3.  按照行方新要求，编写相关技术文档、代码扫描、漏洞扫描及部署包； 预估 1-2 mds
4.  出厂抽样测试验证目前代码版本及功能

steve:
@所有人，本周二开始，大家花费在CDB 人天项目上的工时请填写到这个项目上，CDB - RFR & Extension(2222 MDs)，谢谢！ 

与@王卉 讨论后，修改并添加步骤如下:
1.  CFETS Java client端改造, （接入交易要素、清算路径等）；与CFETS 联调测试 
-- 前提: CFETS现有接口已提供所需的交易要素及清算路径 ； 预估 10 mds
2.  进一步分析交易后处理（K 实施，已上线）与 批量verify是否存在需要合并的情况（交易后处理 已实现一个Trade Server；批量verify也需要Trade Server) ; 预估 ２md
3.  按照行方新要求，编写相关技术文档、代码扫描、漏洞扫描及部署包； 预估２.５ mds
4.  出厂抽样测试验证目前代码版本及功能　预估 ４ mds
5. 业务相关文档编写 预估 2.５mds
6. 按交易类型抽样测试：报文验证　预估 ３mds
共24 mds

Control Panel\All Control Panel Items  控制面板
Control
Control Panel\Network and Internet\Network Connections  网络设备、端口设置

mstsc 远程 
dxdiag  诊断，系统信息
devmgmt.msc  设备管理器

------------------------------

## 20210602

www2.summitsupport.com\rngt\Notes.aspx

sAMOUNT – Currency amounts
sGRATE – generic rates
sIRATE – Interest rates
sXRATE – FX Rate
sLPRICE – Futures, listed option, bond prices
sSTRIKE – Option strike

------------------------------

## 20210603

daily review

还在上传/合并代码到自贸区trunk（新的基线）， 传了多次（从昨天到现在）， 都报错（1.8G）

@侃侃而谈 @神龙卷轴 @黄文荣 做國開的接口的時候, 記得出落地文檔的時候, 出完data以後再出一個flg檔, 接收的時候, 看到flg檔再去取data檔, 因為曾經發生過data傳送太慢, 接收的時候把傳送一伴的文件讀進來處理, windows的api沒法判斷

ADB的話，是Ben用etoolkit/soap寫

------------------------------

## 20210604

《自贸区编译环境上线记录表》是用来记录每次上线的程序、代码、配置、脚本等的版本信息，如果以后有上线的需求， 请在这个表里做维护

stkhelp查詢關聯關係

62要取哪條曲線的curve, 然後要導入到56的哪一條curve

56的利率曲線導入用mktimp的指令來做, @R 你跟他一起看一下導入的格式, 然後再讓黃文榮寫的代碼取62的curve轉換成導入的格式

smt http://localhost:8090/smt/index.jsp

可以参考这个SOFR.txt，把v62上导出的转换成mktimp 工具使用的文件格式．

从 dmCURVECHAR /dmCURVE 拿出数据，转下格式，用mktimp导入就可以
CURVEHEAD dmCURVECHAR 	sCURVELIST 


CCY USD
INDEX SOFR
DATE 4/2/2021
ID MASTER
USD SOFR ZERO
1/20/1997 0.709701522795
1/21/1997 0.709701522795
1/30/1997 2.036539981528
2/25/1997 2.385908288716
4/23/1997 2.755504614461
1/23/1998 2.846573810299
1/25/2000 2.961601436523

Entity Name , DB Table , Data Struct


------------------------------

## 20210605

            char * sGetEnvVarString( char * pKey )

            pKey     : Specifies information needed (eg "SUMMITHOME")
			
			
STD: State Transition Diagram 状态迁移图,主要应用于软件工程建模。 交易生命周期
MUST (multi underlying structured tool) 各种债券利率汇率组合
Straight-through-processing (STP)外汇交易商通过直通式处理系统 , 前中后一体化直通
real-time (RT)实时 
 
------------------------------

## 20210606

MODULE = hello
MAIN.cc = hello.cc
AUX.cc =
SOURCES.h =

SOURCES.cc = $(MAIN.cc) $(AUX.cc)
SOURCES = $(SOURCES.cc) $(SOURCES.h)
EXE = $(MAIN.cc:.cc=)

RCSDIR=$(RCSROOT)/src/app/$(MODULE)

all_target($(SUMMITEXE)/$(EXE))
ccrep_object_file_rule()
build_ccrep_exe($(EXE), )
build_all_depend()
set_RCS()
make_only_sources()

------------------------------

MODULE = toolkit

SOURCES.cc = toolkit.cc ent_tutor.cc
SOURCES.h =
SOURCES = $(SOURCES.cc) $(SOURCES.h)

RCSDIR=$(RCSROOT)/src/app/$(MODULE)

all_target($(SUMMITEXE)/toolkit   \
	     $(SUMMITEXE)/ent_tutor )

ccrep_object_file_rule()

build_ccrep_exe(ent_tutor,)
build_ccrep_exe(toolkit,)

build_all_depend()
set_RCS()
make_only_sources()

------------------------------

SUBDIRS=
SOURCES.cc = metadata.cc \
	   stkenum.cc 

SOURCES.h = 
SOURCES=$(SOURCES.cc) $(SOURCES.h) metadata.incl stkinterfacedef.incl \
                                   metadata.mthd 


EXTRAINC=

/* Ensure that this dir compiles without Roguewave and Orbix */
RWINC=
ORBIXINC=
ORBIX2K_INC=

/* Don't use PCH in this dir */
DSUMMITUSEPCH = 
CCPCHFLAG     = 
PCHOBJECT     = 

MODULE=rtdata
NEW_MODULE=su_stkrtdata
RCSDIR=$(RCSROOT)/src/stk/$(MODULE)
make_cc_tmpl_lib()
make_only_sources()
set_RCS()

------------------------------

```
MODULE=client_mquant_must_conv
NEW_MODULE=client_mquant_must_conv
SUBDIRS=

SOURCES.cc = \
client_must_conv_Impl.cc \
client_must_conv_addin.cc 	

SOURCES.h = client_must_conv_Impl.h


SOURCES = $(SOURCES.cc) $(SOURCES.h)

EXTRAINC= \
-I$(XMLINC)/xercesc \
-I$(XMLINC) \
-I$(SUMMITROOT)/include/mquant_addrisks \
-I$(SUMMITROOT)/include/structinst/mustapi \
-I$(SUMMITROOT)/include/structinst \
-I$(SUMMITROOT)/include/structinst/components \
-I$(SUMMITROOT)/include/structinst/formula \
-I$(SUMMITROOT)/include/structinst/utilities \
-I$(SUMMITROOT)/include/xml \
-I$(SUMMITROOT)/include/structinst/xml \
-I$(SUMMITROOT)/include/structinst/factory \
-I$(SUMMITROOT)/include/structinst/operands \
-I$(SUMMITROOT)/etc/proto/mps_must_price/cpp \
-I$(SUMMITROOT)/src/distcmpnts/mps_must_clnts \
-I$(SUMMITROOT)/src/stk/mps_must_price \
-I$(REFROOT)/include/mquant_addrisks \
-I$(REFROOT)/include/structinst/mustapi \
-I$(REFROOT)/include/structinst \
-I$(REFROOT)/include/structinst/components \
-I$(REFROOT)/include/structinst/formula \
-I$(REFROOT)/include/structinst/utilities \
-I$(REFROOT)/include/xml \
-I$(REFROOT)/include/structinst/xml \
-I$(REFROOT)/include/structinst/factory \
-I$(REFROOT)/include/structinst/operands \
-I$(REFROOT)/etc/proto/mps_must_price/cpp \
-I$(REFROOT)/src/distcmpnts/mps_must_clnts \
-I$(REFROOT)/src/stk/mps_must_price \
-I$(CMS_INC) \
-I$(APR_INC) \
-I$(PROTODIR) \
-I$(GPBCPPINC) \
-I$(GFCPPINC) \
-I$(BOOST_INC)

#if defined(OSFAMILY_WINDOWS)
EXTRACCOPTS = /bigobj
#endif

/* Don't use PCH in this dir */
DSUMMITUSEPCH = 
CCPCHFLAG     = 
PCHOBJECT     = 

LIB_CORE_MPS_MUST_PRICE=stkmps_must_price


#if defined(OSFAMILY_WINDOWS)
CLEAN_MODULE_SPECIFIC_FILES=*.rc *.def *~
EXTRALIBLIBS=libstkmquant_factory.lib lib$(LIB_CORE_MPS_MUST_PRICE).lib $(LIBXMLLIB) $(LIBXML)
#else
EXTRALIBLIBS=-L$(STKLIB) -l$(LIB_CORE_MPS_MUST_PRICE) -lstkmquant_addrisks $(LIBXMLLIB) $(LIBXML)
#endif

#if ( defined(OSFAMILY_UNIX) && !defined(ARCHITECTURE_SPARC) && !defined(OSVERSION_LINUX) && defined(ARCHITECTURE_X86) && defined(MEMORYMODEL_64BIT) ) 

all:
	@echo "This folder doesn't compile on this platform"

#else

make_cc_tmpl_lib_lib($(EXTRALIBLIBS))


set_RCS()
make_only_sources()

#endif

```

------------------------------

SUBDIRS=
SOURCES.cc = metadata.cc \
	   stkenum.cc 

SOURCES.h = 
SOURCES=$(SOURCES.cc) $(SOURCES.h) metadata.incl stkinterfacedef.incl \
                                   metadata.mthd 


EXTRAINC=

/* Ensure that this dir compiles without Roguewave and Orbix */
RWINC=
ORBIXINC=
ORBIX2K_INC=

/* Don't use PCH in this dir */
DSUMMITUSEPCH = 
CCPCHFLAG     = 
PCHOBJECT     = 

MODULE=rtdata
NEW_MODULE=su_stkrtdata
RCSDIR=$(RCSROOT)/src/stk/$(MODULE)
make_cc_tmpl_lib()
make_only_sources()
set_RCS()

------------------------------

```
#if !defined(OSFAMILY_WINDOWS)
$(info This directory only builds on Windows)
#else

#if ( SYMBOLS == 1)
BUILDFLAG = debug
#else
BUILDFLAG = release
#endif

SOURCES.csharp = \
TaskManagerSample.csproj

SOURCES= \
$(SOURCES.csharp) \
run.bat

MODULE=
RCSDIR=$(RCSROOT)/etc/samples/taskmanager/FrontEndMethods

CURRENTDIR=/etc/samples/taskmanager/FrontEndMethods

#if defined (BUILDCYGWIN)
DLLPATH=$(SUMMITDRIVECYG)/$(SUMMITROOT)$(CURRENTDIR)/bin/$(BUILDFLAG)/FrontEndMethods.dll
#else
DLLPATH=$(SUMMITDRIVE)/$(SUMMITROOT)$(CURRENTDIR)/bin/$(BUILDFLAG)/FrontEndMethods.dll
#endif

all: $(DLLPATH)

$(DLLPATH): $(SOURCES.csharp)
	$(IDEDIR)/IDE/devenv.com $(SOURCES.csharp) /build $(BUILDFLAG)

clean:
	-rm -rf obj bin *~
#endif
set_RCS()

```


------------------------------

## 20210607

ExportSOFR

3.2	接口开发和技术测试	进行中	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	接口1：Sum2Sum STP Server		05/31/2021	06/30/2021	邹长根
	接口2：Sum2Sum Utility		07/01/2021	07/07/2021	邹长根
	接口3：Sum2Sum Adapter/Loader		05/31/2021	06/30/2021	陆侃
	接口4：Flow Export STP Server		07/01/2021	07/15/2021	邹长根
	接口5：FlowMTM Gen Utility		07/15/2021	07/21/2021	邹长根
	接口6：FlowMTM Import Utility		07/01/2021	07/15/2021	陆侃
	接口7：Zero Curve Export Utility		05/31/2021	06/10/2021	黄文荣
	接口8：Zero Curve Import Utility		06/10/2021	06/11/2021	黄文荣
	接口9：SWAP Transition Adj function		07/01/2021	07/15/2021	邹长根/陆侃
3.3	GUI交易界面开发和技术测试	未开始	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	SWAP/MM/CAP/FLOOR Asset Detail 開發		06/14/2021	06/30/2021	黄文荣
	Bond Definition Asset Detail 開發		06/14/2021	06/30/2021	黄文荣
	SWAP Transition功能		06/14/2021	06/30/2021	黄文荣
3.4	报表开发和技术测试	未开始	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	Rate Reset Missing Report		07/01/2021	07/15/2021	黄文荣
3.5	批量脚本调整和技术测试	未开始	07/01/2021	07/15/2021	邹长根/全睿/Ray Huang
	總行/港行/自貿區腳本調整		07/01/2021	07/15/2021	黄文荣/全睿
	Summit RFR腳本開發		07/01/2021	07/15/2021	黄文荣/全睿
3.6	技术文档编写	未开始	07/16/2021	07/19/2021	邹长根/陆侃/黄文荣


------------------------------

## 20210608

gcc --version
g++ -std=c++11 -o main main.cpp 
echo $?

g++ -pthread -o test test.o init.o ethernet.o
g++ -lpthread -o test test.o init.o ethernet.o



1. -l(小写L)
     当库文件在/lib、/usr/lib、/usr/local/lib三个目录下时，可直接用-l链接。-l参数后紧跟库名，库名和库文件名的关系如下：以数学库为例，它的库名为m，库文件名为libm.so，把库文件名的头lib和尾.so去掉即为库名。

2. -L
     当库文件在自定义目录下时，需要用-L链接，-L参数是表示库文件所在的目录名。如果把libtest.so或者libtest.a放在/yuzhan/test/目录下，那链接参数为：-L /yuzhan/test -ltest

3. -I(大写i)
      -I参数用于指定头文件目录，/home/include/、/usr/include、/usr/local/include目录一般不需指定，头文件在其他目录下则需要指定，-I参数可以用相对路径。



------------------------------

## 20210609

@echo off & title 监控文件夹 By 依梦琴瑶
color 0a & mode 35,3
 
::设置要监控的文件夹
set MtrDir=ABC
 
::设置要调用的bat脚本
set Bat=test.bat
 
echo 正在初始化记录文件 ...
(for /f "delims=" %%a in ('dir /a-d/s/b "%MtrDir%\*"') do (
    echo "%%~a"
))>"%tmp%\oFiles.Lst"
 
:Loop
set "Change="
cls & echo 正在监控文件夹中 ...
for /f "delims=" %%a in ('dir /a-d/s/b "%MtrDir%"') do (
    findstr /i "^\"%%~a\"$" "%tmp%\oFiles.Lst" >nul || (
        del /f /q "%%~a"
        set Change=1
    )
)
if defined Change (
    echo 发现新增文件，启动其它脚本。
    start "" "%Bat%"
	call 
)
goto Loop



------------------------------

## 20210610

我們對前中台顧問的基本要求是:
1. 具備資金業務背景 (總行，非分行)，具備金融產品估值的基本知識
2. 熟悉 Summit 系統，有實施、使用經驗
3. 有項目實施經驗 (consultancy skill)
三者中至少需要具備兩個，如果三者缺其二，是沒辦法教得來的。

關於第一條的細節說明:
FO 的背景知識要求 - 銀行資金業務，交易流程、交易慣例、交易的 Life Cycle Actions
MO 的背景知識要求 - 銀行資金業務金融產品的風險管理，產品估值基本知識

銀行資金業務涉及的金融產品包含:
1. 外匯即、遠、掉期交易，外匯期權交易
2. 拆借
3. Swap - IRS、CCS
4. 債券 (本幣、外幣)
5. 利率衍生品 - Cap/Floow、Swaption
6. 信用衍生品 Credit Derivatives
7. 結構型產品 Structure Product
8. Total Return Swap
9. Stock
10. Equity Option
11. Equity Return Swap
等銀行會交易的金融產品。



------------------------------

## 20210611

关于填写”LIBOR项目任务+工时“注意事项，昨天于CDB科技领导开会后再次强调如下：
1）每天要按照任务和对应工时，多个任务分成多条记录，任务描述要清晰完整，不能太简略（比如: 接口开发，写方案等等），要写成类似”xxx接口开发--代码编写/编译/技术验证/解决xxx问题等待“，或者“修订《方案》中xx章节，xx内容”
2）增加了新Column“交付件”（比如：文档，代码，脚本，SQL语句，会议纪要，等待）

请大家今天在此模板上添加本周的“任务+工时”记录。

------------------------------

## 20210613

md5.cc

```cpp 
#include <stdio.h>
#include <string>
#include <vector>
#include <iostream>

// #include <iostream>

using namespace std;

void SplitString(const string &s, vector<string> &v, const string &c);
int getFileMD5(string strFpath, string &strMD5);
int writeMD5(string &strMD5, string &strPath, string &strfile);

int main()
{
	string strMD5;
	string strMD5File = "MD5.txt";
	string strPath = "C:/notes/c";
	string strFile = "RFRHO.txt";
	string strFpath = strPath + "/" + strFile;

	getFileMD5(strFpath, strMD5);
	writeMD5(strMD5, strPath, strMD5File);

	cout << "strMD5: " << strMD5 << " strFile: " << strFile << endl;

	return 0;
}

void SplitString(const string &s, vector<string> &v, const string &c)
{
	string::size_type pos1, pos2;
	pos2 = s.find(c);
	pos1 = 0;
	while (string::npos != pos2)
	{
		v.push_back(s.substr(pos1, pos2 - pos1));

		pos1 = pos2 + c.size();
		pos2 = s.find(c, pos1);
	}
	if (pos1 != s.length())
		v.push_back(s.substr(pos1));
}

int getFileMD5(string strFpath, string &strMD5)
{
	string cmd = "certutil -hashfile  \""; //chcp 65001 &&
	cmd += strFpath + "\" MD5";

	string strBuf;

	FILE *pipe = popen(cmd.c_str(), "r");
	if (!pipe)
		return 0;
	char buffer[128] = {0};

	while (!feof(pipe))
	{
		if (fgets(buffer, 128, pipe))
			strBuf += buffer;
		// strcat(strMD5, buffer);
	}
	pclose(pipe);

	vector<string> vBuf;
	SplitString(strBuf, vBuf, "\n"); //可按多个字符来分隔;

	strMD5 = vBuf[1];

	// for (vector<string>::size_type i = 0; i != vBuf.size(); ++i)
	// 	cout << i << vBuf[i] << " " << endl;

	return 0;
}

int writeMD5(string &strMD5, string &strPath, string &strfile)
{
	string strMD5Path = strPath + "/" + strfile;
	FILE *fp = fopen(strMD5Path.c_str(), "w");
	if (fp == NULL)
	{
		printf("文件不存在，结束");
		exit(0);
	}
	else
	{
		// printf("\n%s \t%s \t%s\n", strMD5.c_str(), strMD5Path.c_str(), strfile.c_str());
		fprintf(fp, "%s\t%s\n", strMD5.c_str(), strfile.c_str());
	}

	return 0;
}



```


------------------------------

## 20210613

sudo sed -i "s/\r$//" /home/bin/*.sh
chmod +x /home/bin/*.sh


date -d "2015-08-04 00:00:00" +%s  #1438617600
date -d @1623590767  "+%Y-%m-%d %H:%M:%S"    #2015-08-04

date +%s  #1623592867

date "+%Y-%m-%d %H:%M:%S"  #2021-06-13 22:04:16

awk 'BEGIN{printf "%.2f%%\n",(87/500)*100}' #17.40%
awk -v a=1 -v b=3 '{printf("%.4f",a/b)}'

c=`echo | awk -v a=1 -v b=3 '{printf("%.4f",a/b)}'`
echo $c


检测文件变化shell语句集合

(1) md5sum filename | awk ‘{print $1}’ #在zabbix中会提示权限不足
(2) ls -l filename | awk ‘{ print $5,$9 }’
(3)wc -c filename | awk ‘$2="";1’ 等价于: wc -c myfile |awk ‘{print $1}’
	表示第二个字段置空，然后输出$0 ,上面的也等价于
	wc -c filename | awk '$2=="";1 {print $0}'
(4)ls -l filename|cut -d" " -f5
(5) ls -s nohup.out
(6)ls -alrt nohup.out |awk ‘{print $5}’


md5sum RFRHO.dat >RFRHO.md5
md5sum -c RFRHO.md5
RFRHO.dat: OK

sed -i "s/\r$//" /home/hive/*.sh
a2=$(echo `md5sum -c /home/at/data/RFRFTZ.md5 |cut -d ' ' -f2`)
echo $a2   ##OK




service --status-all
sudo service redis-server start

如果脚本在windowns环境下编辑，需要将脚本转化为unix格式
sed -i "s/\r$//" /home/hive/*.sh

------------------------------

## 20210614

win server 只需要一行命令：
SC create myService binpath= c:\windows\system32\myService .exe start= auto

如果只希望开机执行bat文件,有一种更简单的设置方式:

win+r    gpedit.msc    回车     计算机配置      windows设置      脚本（启动/关机）   在启动里面添加你的bat即可

$ g++ test.cpp -lpthread -o test.o

g++ .\文件名.cpp -o 文件名.exe -lwsock32
./文件名.exe

Linux 用 #include <unistd.h> 和 sleep()，Windos 用 #include <windows.h> 和 Sleep()。
Sleep 括号里的时间，在 Windows 下是以毫秒为单位，而 Linux 是以秒为单位。

system("chcp 65001");
936简体中文。 437英文（美）， 1252 拉丁 1 字符 (ANSI) ， 950 繁体中文 ，437 MS-DOS 美国英语 ， 850 多语种 (MS-DOS Latin1)

delete []p;

$ g++ test.cpp -lpthread -o test.o


------------------------------

## 20210615

netstat -ano，列出所有端口
netstat -aon | findstr "8009"

netstat -tulnp | grep 8005

tasklist | findstr "2720"

taskkill /T /F /PID 2452
强制 （/F参数）

杀死pid为2452的所有进程包括子进程 （/T参数）



------------------------------

## 20210616

SELECT Websites.name, SUM(access_log.count) AS nums FROM Websites
INNER JOIN access_log
ON Websites.id=access_log.site_id
WHERE Websites.alexa < 200 
GROUP BY Websites.name
HAVING SUM(access_log.count) > 200;

Select * from emp where ename='SMITH' and empno=7900 or comm > 500; 
= , > , < , >= , <= , <>（不等于 !=）
WHERE name REGEXP '^[GFs]';  --'^[A-H]'  --'^[^A-H]' 不以 A 到 H 字母开头 [!charlist]
not sal > 1500 ;
comm is null ; 
between 1500 and 3000 ;
sal in (5000,3000,1500);
ename like 'M%';  %表示多个字值，_下划线表示一个字符；
当 0 时转化为 false，1 转化为 true。
EXISTS (SELECT count FROM access_log WHERE Websites.id = access_log.site_id AND count > 200);

SELECT ProductName,UnitPrice*(UnitsInStock+NVL(UnitsOnOrder,0))
FROM Products   /* #SQL Server*/
UnitPrice*(UnitsInStock+ISNULL(UnitsOnOrder,0))  --Oracle
UnitPrice*(UnitsInStock+IFNULL(UnitsOnOrder,0))  -- MySQL

CREATE TABLE Persons
(
P_Id int NOT NULL AUTO_INCREMENT,  --自增 非空 唯一数字 ID int IDENTITY(1,1) PRIMARY KEY,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
PRIMARY KEY (ID), --主键
CONSTRAINT chk_Person CHECK (P_Id>0 AND City='Sandnes')
)

CREATE SEQUENCE seq_person   --oracle
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10


SELECT - 从数据库中提取数据 **DISTINCT** 禁重 select distinct name from A 去重
UPDATE - 更新数据库中的数据
DELETE - 从数据库中删除数据
INSERT INTO - 向数据库中插入新数据
CREATE DATABASE - 创建新数据库  CREATE DATABASE my_db;
ALTER DATABASE - 修改数据库
CREATE TABLE - 创建新表 CREATE TABLE Persons( PersonID int, LastName varchar(255), FirstName varchar(255), Address varchar(255), City varchar(255) );
ALTER TABLE - 变更（改变）数据库表
DROP TABLE - 删除表 DROP TABLE table_name
DROP DATABASE database_name --删除数据库
CREATE INDEX - 创建索引（搜索键）
DROP INDEX - 删除索引
TRUNCATE TABLE table_name --删数据,空表

ALTER TABLE table_name ADD column_name datatype --新增列
ALTER TABLE table_nameDROP COLUMN column_name --删列

SELECT * INTO WebsitesBackup2016  FROM Websites; --备份表
SELECT * INTO newtable FROM table1 WHERE 1=0;  --新空表

SELECT Websites.name, access_log.count, access_log.date
INTO WebsitesBackup2016
FROM Websites
LEFT JOIN access_log
ON Websites.id=access_log.site_id;


INSERT INTO table_name VALUES (value1,value2,value3,...);
INSERT INTO Websites (name, url, country) VALUES ('stackoverflow', 'http://stackoverflow.com/', 'IND');
insert into scorebak select * from socre where neza='neza'   --插入一行,要求表scorebak 必须存在
select *  into scorebak from score  where neza='neza'  --也是插入一行,要求表scorebak 不存在

UPDATE table_name SET column1=value1,column2=value2,...  WHERE some_column=some_value;
UPDATE Websites  SET alexa='5000', country='USA'  WHERE name='菜鸟教程';
DELETE FROM table_name WHERE some_column=some_value;
DELETE FROM Websites WHERE name='Facebook' AND country='USA';

进入cmd，输入sqlplus/ as sysdba，回车，进入sql>
输入 alter user system identified by admin;,这行代码的意思就是修改system用户的密码为admin，这里需要注意的是，代码末尾要加上分号“;”，不然无法修改成功
create user lkSoft identified by admin;，代码的意思是：创建一个用户名为lkSoft的用户，密码为admin
grant connect, resource, dba to 1kSoft; --授权，查看/建表/建库

EXECUTE sp_addlogin @loginame = 'Bella', @passwd = 'ASDFG'  --
用户创建SQL Server登录名Bella，密码为ASDFG
EXECUTE sp_adduser 'Bella', 'Bella'
添加：insert into tablename(name,pass) values('test','1234')
修改：update tablename set name='aabb',pass='5566' where id=1


AVG() - 返回平均值
COUNT() - 返回行数
FIRST() - 返回第一个记录的值
LAST() - 返回最后一个记录的值
MAX() - 返回最大值
MIN() - 返回最小值
SUM() - 返回总和
UCASE() - 将某个字段转换为大写
LCASE() - 将某个字段转换为小写
MID() - 从某个文本字段提取字符，MySql 中使用
SubString(字段，1，end) - 从某个文本字段提取字符
LEN() - 返回某个文本字段的长度
ROUND() - 对某个数值字段进行指定小数位数的四舍五入
NOW() - 返回当前的系统日期和时间
FORMAT() - 格式化某个字段的显示方式

NOT NULL - 指示某列不能存储 NULL 值。
UNIQUE - 保证某列的每行必须有唯一的值。
PRIMARY KEY - NOT NULL 和 UNIQUE 的结合。确保某列（或两个列多个列的结合）有唯一标识，有助于更容易更快速地找到表中的一个特定的记录。
FOREIGN KEY - 证一个表中的数据匹配另一个表中的值的参照完整性。
CHECK - 保证列中的值符合指定的条件。
DEFAULT - 规定没有给列赋值时的默认值


------------------------------

## 20210617

210环境FT密码修改为：summit/1qaz@WSX, summit1/1qaz@WSX。
CDB内网OA账号密码今天修改过，  c0131343 / 131343@cDb


6.2的commref = 5.6的tradeid_exportdate_time

静态数据subtype， bond reference同步记下了么？敲定了
凱美瑞德幫他們做一線運維

債券導入格式，首先計算SEC ID, 如果加了后綴總長度超過20，要從後段刪除到符合長度20， 然後再把原有的Sec ID 放到 other name 上。
如果有另一檔的債券的Sec ID 刪掉了後面的字段跟之前的一樣，那要繼續多刪一個字段....

summit 系统变量

V5.6生产环境界面客制化栏位 
SWAP/MM/CAP/FLOOR Asset Detail 开发
Bond Definition Asset Detail 开发
SWAP Transition功能




------------------------------

## 20210618


停止SMT Distribution Server和eToolkit Manager服务
summit_export
定义一下application definition, 在utility 里可以运行就可以
不過你腳本的start date, end date, CCY, CurveID可能需要調整一下
CCY is [%s], Index is [%s], CurveID is [%s]

run_command cdb_cpcurve -X ${startDate} -Y ${endDate} -FROM USD/LIBOR/CLOSING -TO USD/SOFR/MO



------------------------------

## 20210619

choice /t 1 /c YN /d Y 
choice /t 5 /d y /n >nul

vbs 无窗口运行bat
createobject("wscript.shell").run "C:\Users\chaoy\Desktop\SleepPc.bat",0

新建一个记事本文件，保存为abc.vbs，在文件中加入如下代码：
Set shell = Wscript.createobject("wscript.shell")
a = shell.run ("BAT文件所在文件夹\要运行的BAT文件.bat",0)

set GuWS=WScript.CreateObject("WScript.Shell")
GuWS.Run "test.bat",vbhide

当前时间  echo %date% %time% 

echo  %date:~0,4%%date:~5,2%%date:~8,2%0%time:~1,1%%time:~3,2%%time:~6,2%

& 连接符，命令格式 [...] command1 & command2 用来分隔一个命令行中的多个命令。Cmd.exe 运行第一个命令，然后运行第二个命令。如：@echo 第一个命令&@echo 第二个命令
&& 代表上一句执行成功,命令格式 [...] command1 && command2 只有在符号 && 前面的命令成功时，才用于运行该符号后面的命令。Cmd.exe运行第一个命令，然后只有在第一个命令运行成功时才运行第二个命令。如：@echo 测试>>测试.txt&&@echo *********测试.txt写入成功********
|| 代表上一句执行失败,命令格式 [...] command1 || command2 只有在符号 || 前面的命令失败时，才用于运行符号 || 后面的命令。
Cmd.exe 运行第一个命令，然后只有在第一个命令未能运行如：dir *.pdf||echo *************没有找到pdf文件**************
| 管道符，这个命令的作用不一样了，就是让前一命令的输出当做后一命令的输入,就是说前面命令的结果当做一个参数传递给后面命令处理如：help|more


set a=123 rem定义一个变量a 赋值为123
echo %a%

调用程序外部参数用%1至%9
a.bat 1 2 3 4 5 6 7 8 9
echo %1

for命令中引用变量
命令行中 for %variable in (set) do command [command-parameters]
批处理文件中 for %%variable in (set) do command [command-parameters]

普通情况下，在BAT脚本中，是没有办法对变量循环赋值的。但有时又确实需要，此时需要启用延缓环境变量。也就是在代码前面加上这句：
SETLOCAL ENABLEDELAYEDEXPANSION
然后对变量赋值的时候，需要在变量后面和=之间加一个空格，如果没有启用延缓环境变量，这么做恰恰是错误的。
set var =%%i
如果要引用这个变量，需要使用！将变量包括起来
echo !var!



------------------------------

## 20210620

'''bat
@REM chcp 65001
@REM call d:\output\md5env.bat
@REM call d:\sumapps\tools\Orbix63\SummitCs01\orbix633\etc\bin\orbix633_env.bat

@ehco off
@call "D:\summit\SMT\env\etkws_env.bat"

@set rfrPath=d:\input
@set rfrmd5Name=RFRMD5.txt
@set rfrmd5fp=%rfrPath%\%rfrmd5Name%
@set sp= 

@if exist %rfrmd5fp% (
    @for /f "tokens=1,2 delims=%sp%" %%x in (%rfrmd5fp%) do (
        @if exist %rfrPath%\%%y (
            @for /f "tokens=1-16 delims= " %%a in ('certutil -hashfile "%rfrPath%\%%y"  MD5') do (
                @if %%x == %%a%%b%%c%%d%%e%%f%%g%%h%%i%%j%%k%%l%%m%%n%%o%%p (
					
                    @REM mktimp -i %rfrPath%\%%y
					@echo ---%date% %time%---%%x---333---
					@call choice /t 1 /d y /n >nul
                )
            ) 
        ) else (
            @echo Import Error : %rfrPath%\%%y no exist, please check it!
        )
    )
) else (
    @echo Import Error : %rfrmd5fp% no exist, please check it!
)
'''


C的struct与C++的class的区别：struct只是作为一种复杂数据类型定义，不能用于面向对象编程。
C++中的struct和class的区别：对于成员访问权限以及继承方式，class中默认的是private的，而struct中则是public的。class还可以用于表示模板类型，struct则不行。


------------------------------

## 20210621

一、创建C#项目

安装 .NET CORE SDK.  dotnet-sdk-5.0.301-win-x64.exe
生成和文件夹名字相同的项目 dotnet new console
dotnet restore 编译项目  生成项目，dotnet build
运行项目，dotnet run
命令行 dotnet help  dotnet new 可以查看帮助

dotnet new mvc -n MvcDemo
发布项目，dotnet publish -f netcoreapp1.1 -c Release

exe 在项目的 . csproj 文件里面加入
< RuntimeIdentifier >win10-x64 </ RuntimeIdentifier >


------------------------------

## 20210622

ActiveMQ

basename 是去除目录后剩下的名字
example：shell>temp=/home/temp/1.test
         shell>base=`basename $temp`
         shell>echo $base
结果为：1.test
dirname 是取目录
example：shell>temp=/home/temp/1.test
         shell>dir=`dirname $temp`
         shell>echo $dir
结果为：/home/temp

另一种实现的方法：
${var##*/} 就是把变量var最后一个/以及左边的内容去掉
${var%/*} 就是把变量var最后一个/以及右边的内容去掉

------------------------------

## 20210623

变量	含义
$0	当前脚本的文件名
$n	传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是$1，第二个参数是$2。
$#	传递给脚本或函数的参数个数。
$*	传递给脚本或函数的所有参数。
$@	传递给脚本或函数的所有参数。被双引号(" ")包含时，与 $* 稍有不同
$?	上个命令的退出状态，或函数的返回值。 #bat echo %ERRORLEVEL% 
$$	当前Shell进程ID。对于 Shell 脚本，就是这些脚本所在的进程ID。
$!	Shell最后运行的后台ID

scp -r   /home/helpteach/project/mallupload/ wasadmin@10.127.40.25:/home/test

如果脚本在windowns环境下编辑，需要将脚本转化为unix格式
sed -i "s/\r$//" /home/hive/*.sh

dos2unix  *.sh

在WIN32编程中,可以使用CreateProcess得到进程的退出码 , dos/bat中 %errorlevel%
多线程编程可以使用GetExitCodeThread等获得线程退出码,

------------------------------

## 20210624

export LANG=zh_CN.gbk
export LANG='zh_CN.gbk'
英文就设置成LANG=en_US.UTF-8，如果是中文就设置成LANG=zh_CN.UTF-8


查看变量 env set  printenv 

用jar命令，前提是要安装dk。
把当前目录下的所有文件打包成game.war
jar -cvfM0 game.war ./

-c   创建war包
-v   显示过程信息
-f    
-M
-0   这个是阿拉伯数字，只打包不压缩的意思

解压game.war

jar -h
su root 123456
find /usr/ -name jdk
yum apt-get jdk
yum search jdk

yum install jdk
jave -version

jar -xvf game.war

解压到当前目录


------------------------------

## 20210625

nbcb中债登接口
k22420 杨 k22421 Q12wsx
k27399 nbcb,112
16L, 4286 , 5L


修改7.4.2的repo、sumrepobal、other
5.3.2repo、sumrepobal、other

tar -zcvf diff.tar.gz



------------------------------

## 20210626

RegisterMethod
ModelDoMethod


dll的调用，采用反射方法

	Assembly assembly = Assembly.LoadFile(dll生成路径);
	Type AType = assembly.GetType(命名空间);
	MethodInfo method = AType.GetMethod(方法名称);
	var t = method.ReturnType.Name;
	object[] parameters = new object[] { 传入参数};
	var returnResult = Convert.ToString(method.Invoke(null, parameters));

returnResult则为自定义方法返回值。

------------------------------

## 20210627

nbcb上清所接口


查看当前登录的用户的表:
  select table_name from user_tables;

Oracle查询库中所有表
1.select * from all_tables where owner='VTATEST';
all_tables查出来是查得所有用户下的表，当然也包括你登录的用下的表，然后加一个where你要查的那个用户名就可以了。（记得用户名要大写）

2.select * from user_tables;
查的单纯是你所登录的用户下的表，不会显示其他用户下的表。

3.select * from tabs;
这个和第2个类一样，但是书写更简单，也是查你所在用户下的表，本人用的最多的是这个。




------------------------------

## 20210628


typedef struct TextOf50Characters
{
   char Text[sTEXT50_ALLOC];

}sTEXT50;

sTEXT50_ALLOC   (sTEXT50_LEN + 1)

typedef double sAMOUNT;



------------------------------

## 20210629


复议，及时在ITMIS提出


【Git】提交代码步骤，中间有conflict，需要手动解决。

1、git stash
2、git pull
3、git stash pop
4、git add --xxx
5、git commit -m "msg"
6、git pull -r 或 git pull -rebase
7、git push origin HEAD:refs/for/master

不rebase可能会导致在没有主动创建分支的情况下，出现各种分支和merge。 


------------------------------

## 20210630

find . -name '*.sql' -exec grep -i 'v\$temp_space_header' {} \; -print

grep -r "v\$temp_space_header" /u01/app/oracle/product/11.1.0/dbhome_1/rdbms/admin/

grep   "v\$temp_space_header" *.sql

grep -riln 'str' ./
-n打印行号，-r是在子目录也要查询 -i忽略大小写 -l打印所有结果

grep -v "grep"  #忽略grep命令本身，在文档中过滤掉包含有grep字符的行


**   ps -aux|grep chat.js| grep -v grep | awk '{print $2}'   **


查找在 /etc 目录下所有文件名中含有 mail 的文件
find /etc/ -name '*mail*'

查找文件大小超过指定值的文件
[root@localhost ]# find ./ -type f -size +100M

find ~ -newer file1 -print 查找比文件file1新的文件

最近几天被修改过的文件  -mmin 最近几分钟
find . -mtime -2  


1. 查找所有".h"文件
find /PATH -name "*.h"

2. 查找所有".h"文件中的含有"helloworld"字符串的文件
find /PATH -name "*.h" -exec grep -in "helloworld" {} \;
**   find /PATH -name "*.h" | xargs grep -in "helloworld"  **

3. 查找所有".h"和".c"文件中的含有"helloworld"字符串的文件
find /PATH /( -name "*.h" -or -name "*.c" /) -exec grep -in "helloworld" {} \;

4. 查找非备份文件中的含有"helloworld"字符串的文件
find /PATH /( -not -name "*~" /) -exec grep -in "helloworld" {} \;
注：/PATH为查找路径，默认为当前路径。带-exec参数时必须以\;结尾，否则会提示“find: 遗漏“-exec”的参数”。


ls *~ |xargs rm -rf
删除所有以~结尾的文件

查看使用某端口的进程
nohup /usr/local/node/bin/node /www/im/chat.js >> /usr/local/node/output.log 2>&1 &
ps -aux|grep chat.js| grep -v grep | awk '{print $2}'
lsof -i:8090
netstat -nap|grep 7779
kill -9  进程号

与系统时间不同步
vim  /etc/timezone  将内容改为 Asia/Shanghai ;  
vim /var/spool/cron/crontab/root
 添加定时任务
 11 6 * * * root ntpdate us.pool.ntp.org;hwclock -w 
 
------------------------------

# 202107


------------------------------

## 20210701

Business trip at NBCB ：shchmonitor coding

clang-format -style=LLVM -i test.cc
clang-format -style=llvm -dump-config > .clang-format

vscode://vscode.github-authentication/did-authenticate?windowid=1&code=89cbacc81ecbd17c1718&state=5d2583a6-306a-4d79-9d93-23c5a35e73b7


编译阶段是相同的，链接阶段g++默认链接c++库，gcc没有。
所以一般情况下用gcc编译c文件，用g++编译cpp文件。
但是也可以用gcc编译cpp文件，但后面需要加一个选项-lstdc++，作用是链接c++库
还可以用g++编译c文件

------------------------------

## 20210702

Business trip at NBCB ：ft_shchmonitor coding

C#winform 容器

用mageui打包后报错：specified entry point not valid，看了manifest文件summitFT.exe architecture是msil，然后我打包从x86改为msil 然后报错

------------------------------

## 20210703

生产环境孟处的密码
1qaz@#EDC

------------------------------

## 20210704

libor测试归档环境服务器口令  1）app server: administrator/Cdbho@56 2)db server: oracle/Kfcs@2021


------------------------------

## 20210705 一

Business trip at NBCB ： coding and git commit/push

C++socket通讯分为服务器和客户端两部分

服务器实现部分

1.调用SOCKET创建本机通讯信息
2.调用BIND函数将本机SOCKET与通讯端口进行绑定
3.bzero将端口套接字长度标准划
4.调用listen监听端口
5.while(1)实时检测客户端连接
6.clienthand=accept()函数获取连接客户端句柄
7.recv(clienthandle,buffer, buffersize)读取客户端发送的信息
8.send(clienthandle,buffer, buffersize)函数向客户端发送信息
9.close(clienthandle)停止会话
 

客户端部分

1.调用SOCKET创建本机通讯信息
2.调用BIND函数将本机SOCKET与通讯端口进行绑定
3.调用connect()函数连接服务器
4.while(1)实时检测服务器发送信息
5.recv(serverhandle,buffer, buffersize)读取客户端发送的信息
6.send(serverhandle,buffer, buffersize)函数向客户端发送信息
7.close(serverhandle)停止会话



------------------------------

## 20210706 二

Business trip at NBCB ：RepurchaseRate Background Color anomaly analysis


driver status記得要清一下




------------------------------

## 20210707 三

Business trip at NBCB ：Cdcmonitor RepurchaseRate numerical accuracy maintenance

cdcmonitor 指令确认，回购利率RATE异常排查 精度异常 0.03038625 

在gdb调试时要打印出一些字符串的内容，通过
p str@str_len  打印字符串时，长度受限，测试linux机器上默认为200个，但实际输出的长度str_len可能大于该值。
结果不能够完全输出，而进行了省略，通过命令set print element 0就可以了。

0x01 查看全局和静态变量
info variables

0x02 查看当前stack frame局部变量
info locals

0x03 查看当前stack frame参数
info args

set print element 0

在循环中设置断点,然后调用c 50继续50次



对断点的控制除了建立和删除外，还可以通过使能和禁止来控制，后一种方法更灵活。

断点的四种使能操作：

enable [breakpoints] [range...] 完全使能
enable                //激活所有断点
enable 4            //激活4断点
enable 5-6            //激活5～6断点
disable [breakpoints] [range...] 禁止
用法举例：
diable                //禁止所有断点
disble 2            //禁止第二个断点
disable 1-5            //禁止第1到第5个断点

enable once [breakpoints] [range...]  使能一次，触发后禁止
enable delete [breakpoints] [range...]使能一次，触发后删除

设置变量，要使用 set var 命令。标准gdb也可以有set命令，用来进行设置gdb。

set var xxx=xxx

gdb调试过程中修改变量的值
(gdb) print x=4
(gdb) set var width=47


例如一个程序名为prog 参数为 -l a -C abc
则，运行gcc/g++ -g  prog.c/cpp -o prog
就可以用gdb调试程序prog
#gdb prog
进入gdb调试界面
输入参数命令set args 后面加上程序所要用的参数，注意，不再带有程序名，直接加参数，如：
set args -l a -C abc
回车后输入
r
即可开


------------------------------

## 20210708 四

Business trip at NBCB ：：Cdcmonitor Cdccommand Analysis

cdcmonitor test requestion analysis
合同查询 AggtFaceAmt 排查 为0 不显示 报文3

Step1：执行语句1
语句1：SELECT * FROM table_name t WHERE t.field1 = field1_key; --查询该字段所在记录的所有信息

Step2：执行语句2
语句2：SELECT * FROM table_name FOR UPDATE; --在FOR UPDATE这个事务执行完毕之前，该表中的数据时无法被更新的，只有在FOR UPDATE执行之后才能解锁该表

Step3：手动进行解锁
Step4：手动修改数据或者执行语句3（UPDATE语句）进行更新数据
语句3：UPDATE table_name t SET t.field2 = field2_key WHERE t.field1 = field1_key

Step5：手动提交当前更新事务或者执行语句4（COMMIT语句）进行更新数据
语句4：COMMIT ;

select * from c_table t where upper(t.name) like '%F%';--将字段全转成大写
select * from c_table t where lower(t.name) like '%f%';--将字段全转成小写
select * from c_table t where t.name like upper('%f%') or t.name like lower('%F%');        ---------效率最低


-- oracle sql 查询前十条数据
select * from b2c_code where rownum <= '10';
-- sql server 查询前十条数据
select top 10 * from b2c_code;

表中按ID降序排列的前十条记录
select rownum,t.* from (select * from test order by id desc) t where rownum<11;

delete 删除表中的数据
drop 删除数据和表结构
alert 修改表结构

select * for update;
commit;


------------------------------

## 20210709 五

Business trip at NBCB ：：Cdcmonitor Cdccommand Analysis
cdcmonitor 指令确认，回购利率RATE精度修复 8位


double dumpSize = (1024000000.1415926535897932384 * 1.0) / 1024 / 1024;
string tempStr = to_string(dumpSize);
std::stringstream ss;
ss << setiosflags(ios::fixed) << std::setprecision(1) << dumpSize;　　//此处1代表保存N为小数
tempStr = ss.str();

 


------------------------------

## 20210710

linux清屏命令
1、clear命令 、Ctrl+l(小写的L)  后翻一页
2、reset命令 刷新终端屏幕 慢 终端控制错乱
4、 ** printf "\033c"  ** 命令


------------------------------

## 20210711

summit_export -ENT CUSTOMER -SQL "where dmCUSTOMER.Audit_Current = 'Y' and dmCUSTOMER.cdmIssuer = 'Y' " -XML -O D:\summit\Out\CUSTOMER.xml   

------------------------------

## 20210712 Mon

Business trip at NBCB： Cdcmonitor respone(BJ0301_OS03) debug
CDCCommander 批量查询合同回报后BJ0300_OS03，合同处理为成功状态CS00, 不再更新合同数据;

就是把要监测的进程在fork（）后直接跟exec系列函数把它变成守护进程的子进程，然后在父进程中waitpid（）获取子进程的异常退出情况，根据status做相应处理即可。 之前一直迷惑的原因就是不知道exec系列函数的作用。

summit_export
用static_import導入location, 已經可以產生store procedure, 表示他已經通過summituser登入, 取到DB帳號密碼, 取了location的entity定義, 所以才能生成store procedure
市場數據要用mktimp來導入, 或是用cpcurve從一個環境複製到另一個環境

现场技术支持


------------------------------

## 20210713 Tue

现场技术支持
Business trip at NBCB： Shchmonitor querybond noreply


命令行Summit_export导出，static_import导入


template<typename T>
inline T labs( const T & x ){return x<0?-x:x;}
 
template<typename T>
inline int sgn( const T & x ){return x<0?-1:(x?1:0);}
 
inline int d_round( const double & x ){return (int)(sgn(x)*(labs(x)+0.50001));}


------------------------------

## 20210714 Wed

现场技术支持
Business trip at NBCB ： ReutersDataImport import error(255)



以snmpd进程为例，以下脚本检查进程状态是否为running，如果不是则重新启动进程。

```
#!/bin/bash
SNMPD=`systemctl status snmpd | grep Active | awk '{print $3}' | cut -d "(" -f2 | cut -d ")" -f1`
if [ "$SNMPD" == "running" ]
        then
            echo "snmpd service is running..." 
        else
            systemctl restart snmpd
fi  
```

```
@echo off
set "str=0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z"
for %%1 in (%str%) do (
echo.>>"h%%~1.js"
)
```



------------------------------

## 20210715 Thu

现场技术支持
Business trip at NBCB ： ReutersDataImport export data analysis(xml)
ReuterDataImport error255，导入异常排查，读表中Name字段异常（获取不到，未录入）

double dround(double x,int bit)//double round
{
    double y=1;
    for(int i=0;i<bit;i++)
        y *=10;
    return (int)(x*y+0.5)/y;
}

double round(double r)
{
    return (r > 0.0) ? floor(r + 0.5) : ceil(r - 0.5);
}

telnet 127.0.0.1 8000

------------------------------

## 20210716 Fri

Business trip at NBCB ： Wind2Reuters data analysis

ft_cdcmonitor issuer al04 al06 getalldepoissuer
ft_shchmonitor issuer  al06

 -#pragma comment (lib, "ws2_32.lib")



------------------------------

## 20210717 Sat

/usr/include/
这个目录下的文件大多是C 标准头文件
/usr/include/c++
这个下面就是C++标准头文件

头文件和库文件搜索路径
搜索顺序为：
①先搜索当前目录  #include “headfile.h”
②然后搜索-I指定的目录 #include<>
③再搜索gcc的环境变量CPLUS_INCLUDE_PATH（C程序使用的是C_INCLUDE_PATH）
④最后搜索gcc的内定目录

/usr/include
/usr/local/include
/usr/lib/gcc/x86_64-redhat-linux/4.1.1/include


各目录存在相同文件时，先找到哪个使用哪个。

server_socket  = socket()
bind(server_socket,... )
listen(server_socket, 5)

while (1)
{
    confd = accept(server_socket, );
    pid_t pid = fork();
    if (pid == 0) { // 子进程
        close(server_socket);
        do_something(connfd); // read or write
        close(connfd);
        exit(0);
    } else if (pid == -1) { // error

    } else {       // 父进程
         close(connfd);
    }

}
close(server_socket);

使用多线程编程，而不是多进程编程，因为线程是处理器调度的最小单元，也称为轻量级进程。多线程编程可以减少处理机的空转时间，支持多处理器以及减少上下文切换开销, 比创建进程小很多。

使用线程池技术，即预先创建若干个线程，没必要不断动态创建和销毁线程，减少消耗。

使用I/O复用技术，应用select、poll或者epoll提高系统效率。

利用高效的事件处理方式：Reactor模式和Proactor模式。

char a='a';
char str[3];//再大点也没有问题
snprintf(str,sizeof(str),"%02d",a);

------------------------------

## 20210718 Sun

1.用kill来杀死某一个进程
kill，加选项-9，加PID，表示杀死进程编号为PID的这个进程
-1 重启
kill -9 PID
下面表示杀死进程PID为2899的进程
[root@localhost ~]# kill -9 2899

2.用killall杀死一类进程
killall，加选项-9，加服务名， 表示杀死该服务的所有进程
-1 重启
killall -9 service
下面表示杀死httpd服务的所有进程
[root@localhost ~]# killall -9 httpd

3.用pkill踢出某个终端
pkill，加选项-9，加终端号，表示踢出该终端
-1 重启
pkill -9 pts/0
下面表示提出我的远程登录终端pts/0
[root@localhost ~]# pkill -9 pts/0

Visual Studio 2017 运行 ctime 报错 C4996 显示 ctime 为不安全函数，推荐使用 ctime_s 代替 ctime。除了在 #include 前面加上 #pragma warning(disable:4996) 还可以更改预处理定义：项目 -> 属性 -> 配置属性 ->C/C++ -> 预处理器 -> 预处理器定义，增加：_CRT_SECURE_NO_DEPRECATE

```系统日期和时间
#include <iostream>
#include <ctime>
 
using namespace std;
 
int main()
{
	struct tm t;   //tm结构指针
	time_t now;  //声明time_t类型变量
	time(&now);      //获取系统日期和时间
	localtime_s(&t, &now);   //获取当地日期和时间
 
	cout << "当前系统时间：" << endl;
	cout << t.tm_year + 1900 << "/"
		<< t.tm_mon + 1 << "" << "/"
		<< t.tm_mday << " "
		<< t.tm_hour << ":"
		<< t.tm_min << ":"
		<< t.tm_sec << endl;
 
	system("pause");
	return 0;
}
```

```

#include <windows.h>
#include <iostream>
 
using namespace std;
 
int main(int argc, char* argv[])
{
 
	SYSTEMTIME st = { 0 };  
	GetLocalTime(&st);  //获取当前时间 可精确到ms
	printf("%d-%02d-%02d %02d:%02d:%02d\n",
		st.wYear,
		st.wMonth,
		st.wDay,
		st.wHour,
		st.wMinute,
		st.wSecond);
}
```

select Epoll 

epoll的操作就这么简单，总共不过4个API：epoll_create, epoll_ctl, epoll_wait和close。



------------------------------

## 20210719 Mon

CDB: ZeroCurveImport: Timing script & Environment variable 

set NOW_TIME_HH=%time:~0,2%
if "%NOW_TIME_HH%" lss "10" (set NOW_TIME_HH=0%time:~1,1%) else (set NOW_TIME_HH=%time:~0,2%)
set NOW_TIME=%date:~0,4%%date:~5,2%%date:~8,2%%NOW_TIME_HH%%time:~3,2%%time:~6,2%

%date:~0,4% 取date文件，从第0位开始往后取4位，即年份的阿拉伯数字； 
%date:~5,2% 从第5位开始往后取2位，即月份； 
%date:~8,2% 从第8位开始往后取2位，即当月的第几天。 

tzutil /g ，即可查看电脑当前的时区

DOS 格式化日期时间输出
if "%date:~5,2%" lss "10" (set mm=0%date:~6,1%) else (set mm=%date:~5,2%)
if "%date:~8,2%" lss "10" (set dd=0%date:~9,1%) else (set dd=%date:~8,2%)
if "%time:~0,2%" lss "10" (set hh=0%time:~1,1%) else (set hh=%time:~0,2%)
if "%time:~3,2%" lss "10" (set nn=0%time:~4,1%) else (set nn=%time:~3,2%)

echo [%Date:~0,4%-%mm%-%dd%-%hh%-%nn%]

set _my_datetime=%date%_%time%
set _my_datetime=%_my_datetime: =_%
set _my_datetime=%_my_datetime::=%
set _my_datetime=%_my_datetime:/=_%
set _my_datetime=%_my_datetime:.=_%

@echo off
for /F "usebackq tokens=1,2 delims==" %%i in (`wmic os get LocalDateTime /VALUE 2^>NUL`) do if '.%%i.'=='.LocalDateTime.' set ldt=%%j
set ldt=%ldt:~0,4%-%ldt:~4,2%-%ldt:~6,2% %ldt:~8,2%:%ldt:~10,2%:%ldt:~12,6%
echo Local date is [%ldt%]
Local date is [2021-07-22 00:07:23.047]S

------------------------------

## 20210720 Tue

CDB: extpriceimp: Compile & Test

VS挂EXE调试代码
vs源代码：属性---调试---命令：（EXE的绝对路径）

              属性----链接---输出文件：EXE的同目录/源代码.dll

启动：VS工具栏F5,之后就可以通过本地代码启动exe并在本地进行断点调试



------------------------------

## 20210721 Wed

CDB: cdb_cpcurve: Compile & Test



set CLIENTPATH=D:\SummitApps\client

set CLIENTPATH=D:\SummitApps\V6.0\client

select * from DMENTITY t;  --1903
select * from DMPROPERTY t;  --20410

select * from all_tables t;  --1972
select * from V$DATABASE ; --
select * from v$version ; -- 11.2.0.4.0


select * from DMENTITY t where lower(t.tablename) like '%filter%';



------------------------------

## 20210722 Thu

CDB: ZeroCurveImport: ESB & Adapt

echo %ERRORELEVEL%


------------------------------

## 20210723 Fri

CDB: ratereset: 156.4HK Env Config & Test

1.编译xerces，获得dll文件和lib文件

2.将dll文件和lib文件拷贝到使用xerces的工程目录里面去

3.配置VS2017

　　C/C++  ->  All Options -->Additional Include Directories  放入xerces工程的src目录

　　Linker   ->  All Options -->Additional Dependencies 放入lib文件名

　　Linker   ->  All Options -->Additional Library Directories 放入$(OutDir)

5.包含头文件

6.加上命名空间

　XERCES_CPP_NAMESPACE_USE

 
------------------------------

## 20210724 Sat

developer用：
set serveroutput on;   --确保可以打印输出
declare var2 number;
begin 
var2:=22;
dbms_output.put_line(var2);
end;


pl/sql developer用：
declare var_sql varchar2(200);
begin
var_sql:='good';
DBMS_OUTPUT.PUT_LINE(var_sql);
end;
--或者在定义的时候赋值
declare var_sql varchar2(200):='good';
begin
DBMS_OUTPUT.PUT_LINE(var_sql);
end;


------------------------------

## 20210725 Sun

以下關掉Zscaler只供參考……
1.首先用cmd （run as administrator) 
2. Go to c:\program file (x86)\Zscaler 
3. Rename ZSATunnel ZSATunnelXXXX
4. 重起電腦


------------------------------

## 20210726 Mon

CDB: ratereset: 156.4HK Env Config & Test

If data model is extended by client, only “changes” to the meta tables delivered as SQL
• Steps to integrate changes into master database
1. Backup target database
2. Run delivered SQL against database (metadata.sql.changes)
convertdb –F metadata.sql.changes
3. Run the data model generator (genmeta)
4. Recompile the runtime library (rtdata)
5. Run generated DDL SQL scripts against the database
convertdb –F metadata.sql.applychanges


------------------------------

## 20210727 Tue

回购定盘利率＝∑回购价格X回购成交量/∑回购成交量X(回购天数/实际占用天数)（20170522前）
回购定盘利率＝∑当日逐笔成交价格X当日逐笔成交量/当日总成交量


------------------------------

## 20210728 Wed

處理一下數據庫的archive log
1、登录DB Server (用OS oracle用户）
2、找到数据库归档位置
cd /oralog/OSUM1/arch
3、手工删除历史的归档日志文件
ls -lrt |more
用rm 删除时间戳较早的文件
4、登录数据库切换归档日志
sqlplus / as sysdba
alter system switch logfile;
alter system switch logfile;
alter system switch logfile;
alter system switch logfile;
alter system checkpoint;
quit
5、登录应用服务器检查数据库是否可以连接使用

------------------------------

## 20210729 Thu

taskkill /f /im irricexport.exe /t


------------------------------

## 20210730 Fri

[ -z STRING ] 如果STRING的长度为零则为真 ，即判断是否为空，空即是真；
[ -n STRING ] 如果STRING的长度非零则为真 ，即判断是否为非空，非空即是真；
[ STRING1 = STRING2 ] 如果两个字符串相同则为真 ；
[ STRING1 != STRING2 ] 如果字符串不相同则为真 ；
[ STRING1 ]　 如果字符串不为空则为真,与-n类似

-a 与 &&
-o 或 ||
!  非

INT1 -eq INT2           INT1和INT2两数相等为真 ,=
INT1 -ne INT2           INT1和INT2两数不等为真 ,<>
INT1 -gt INT2            INT1大于INT1为真 ,>
INT1 -ge INT2           INT1大于等于INT2为真,>=
INT1 -lt INT2             INT1小于INT2为真 ,<</div>
INT1 -le INT2             INT1小于等于INT2为真,<=

------------------------------

## 20210731 Sat

空目录
sed -i 's/>RFR</>RFRHO</g' h1.xml 
`ls -l filename | awk '{print $5}' `
[ "$(ls -A $DIR)" ]


echo 'hello' | tr 'a-z' 'A-Z'  #HELLO
echo 'HELLO' | tr 'A-Z' 'a-z'  #hello

${tset^^}大写    ${tset,,} 小写

if echo '$name' | grep -qwi "tom" 
then
elif echo '$name' | grep -qwi "tom" 
else
fi

检测shell 脚本语法 -v 每一行
bash -vn 1.sh



------------------------------

# 202108 Auegst

------------------------------

## 20210801 Sun

--#!/bin/bash
string="hello,shell,haha"
OLD_IFS="$IFS"
IFS=","
array=($string)
IFS="$OLD_IFS"
for var in ${array[@]}
do
   echo $var
done

--#!/bin/bash
string="hello,shell,haha"  
array=(${string//,/ })  
for var in ${array[@]}
do
   echo $var
done 



string="hello,shell,split,test"  
array=(`echo $string | tr ',' ' '` )  
 
for var in ${array[@]}
do
   echo $var
done 


------------------------------

## 20210802 Mon

CDB: IRRicExport: add CVID parameter

oracle清空数据库脚本

BEGIN 
    FOR obj IN 
    (SELECT object_name,object_type from user_objects 
    WHERE object_type='PROCEDURE' 
    OR object_type='TABLE' 
    OR object_type='VIEW' 
    OR object_type='FUNCTION' 
    OR object_type='PACKAGE' 
    OR object_type='SEQUENCE' 
    ) 
    LOOP 
        IF obj.object_type='TABLE' THEN 
           EXECUTE IMMEDIATE 'DROP '||obj.object_type||' '||obj.object_NAME||' CASCADE CONSTRAINTS'; 
        ELSE 
            EXECUTE IMMEDIATE 'DROP '||obj.object_type||' '||obj.object_NAME; 
        END IF; 
   END LOOP;     
END;


------------------------------

## 20210803 Tue

CDB: IRRicExport: export request file


#include <iostream>
#include <xercesc/util/XMLString.hpp>

using namespace XERCES_CPP_NAMESPACE;

int main()
{
    try
    {
        XMLPlatformUtils::Initialize();
    }
    catch (const XMLException& ex)
    {
        char* message = XMLString::transcode(ex.getMessage());
        std::cerr << "Error during Xerces-c Initialization.\n"
            << "  Exception message:"
            << message;
        XMLString::release(&message);
        return 1;
    }

    const XMLCh* str = XMLString::transcode("bcdfg");

    // Implement a simple regex that uses "character class subtraction"
    // Should match any string that does not contain vowels
    const XMLCh* pattern = XMLString::transcode("[a-z-[aeiuo]]+");

    if (XMLString::patternMatch(str, pattern) != -1)
    {
        std::cout << "Match!" << std::endl;
    }
    else
    {
        std::cout << "No match." << std::endl;
    }

    XMLPlatformUtils::Terminate();
    return 0;
}

------------------------------

## 20210804 Wed

CDB: flowmtmadapter: Import Swap.xml


double* getNameValue(char *name)
{
	std::ifstream file;
	std::string buf, bufFromFile, beginName, endName;
	int j = 0;
	char *value = new char[];
	double *alpha = new double[];
 
	if (name == NULL ) {
		std::cout << "name and value is invalid" << std::endl;
		exit(1);
	}
	beginName.append("<");
	beginName.append(name);
	beginName.append(">");
	endName.append("</");
	endName.append(name);
	endName.append(">");
 
	file.open("SVM_HOG.xml");
	if (!file.is_open()) {
		std::cout << "error in open file ";
		exit(1);
	}
 
	while (!file.eof()) {
		file >> bufFromFile;
		buf += bufFromFile;
	}
	file.close();
	//std::cout << buf << std::endl;
	while (buf.find(beginName) != -1)
	{
		int begin, end;
		begin = buf.find(beginName);
		end = buf.find(endName);
		if (begin >= end) {
			std::cout << "error in find " << name << " Item" << std::endl;
			exit(1);
		}
		for (int i = 0; i < end - begin - beginName.length(); i++) {
			value[i] = buf.at(begin + beginName.length() + i);
		}
		value[end - begin - beginName.length()] = '\0';
		double i = atof(value);
		cout << i << endl;
		alpha[j] = i; j++;
		buf = buf.substr(end+sizeof(endName), buf.find('\n'));
	};
	return alpha;
}
 


------------------------------

## 20210805 Thu

CDB: flowmtmadapter: CleanEntityXML


------------------------------

## 20210806 Fri

CDB: flowmtmadapter: TradeRemoveTag


------------------------------

## 20210807 Sat


shell for循环输出目录下的文件名
 

test.sh文件：
#!/bin/bash
for file in `ls`;do
        echo $file
done
输出
复制代码
bogon:test macname$ chmod +x test.sh
bogon:test macname$ ./test.sh 
case
html
report
run.sh
test.sh

------------------------------

## 20210808 Sun

demofun(){
    for file in `ls $1`
    do
        if test -f $file
        then
            echo "file:  $file"
        elif test -d $file
        then
            echo "path: $file"
        fi
    done
}

path="/home/lwang/Desktop/wujuan"
demofun $path

------------------------------

## 20210809 Mon

CDB: ZeroCurveImport: add new parameter(-COM)

--#!/bin/bash
#方法一 
dir=$(ls -l /usr/ |awk '/^d/ {print $NF}')
for i in $dir
do
 echo $i
done 
--#######
#方法二
for dir in $(ls /usr/)
do
 [ -d $dir ] && echo $dir
done  
##方法三
 
ls -l /usr/ |awk '/^d/ {print $NF}' ## 其实同方法一，直接就可以显示不用for循环


------------------------------

## 20210810 Tue

CDB: MarketDataExport: 62FRR Import Script

查看目录下面的所有文件：


--#!/bin/bash
cd /目标目录
for file in $(ls *)
do
  echo $file
done
延伸的方法，查看目录下面的所有目录


--#!/bin/bash
cd /export/bak/original_document
for dir in $(ls split*)
do
  [ -d $dir ] && echo $dir #先判断是否是目录，然后再输出
done
--#!/bin/bash
cd /export/bak/original_document
for dir in $(ls split*)
do
  [ -d $dir ] && echo $dir #先判断是否是目录，然后再输出
done


------------------------------

## 20210811 Wed

CDB: MarketDataExport: 56HO Export Script(MKTPOINT)

awk
允许重定向作为
print
语句的一部分。
nawk -v file="$FILE" 'BEGIN{RS=";"}
      /select/{ gsub(/.*select/,"select");gsub(/n+/,"");print file,$0 >> results.txt;}
      /update/{ gsub(/.*update/,"update");gsub(/n+/,"");print file,$0 >> results.txt;}
      /insert/{ gsub(/.*insert/,"insert");gsub(/n+/,"");print file,$0 >> results.txt;}
      ' "$FILE"


awk -F '\t'  'NR>900000 {print $1"\r\n"$2}' 2019050802-1800000.txt > result_2.txt

------------------------------

## 20210812 Thu

CDB: ESB Config: 62FRR/56HO/56HK/56FTUS Config

md5sum file.txt > newfile.md5

md5sum -c newfile.md5  
md5sum -c --status newfile.md5  
echo $?  -->不一致返回1
md5sum file.txt > newfile.md5  -->重新记录md5值
md5sum -c newfile.md5
md5sum -c --status newfile.md5
echo $?  -->不一致返回1

awk -F ":" '{print $NF}' /etc/passwd
awk -F: 'NR==2{print "filename: "FILENAME, $0}' /etc/passwd
ifconfig |grep eth* | awk -F '[ ]+' '{print $1}'
awk '{print $NF}' h1.md5

------------------------------

## 20210813 Fri

CDB: interface: Recompile & debug 

利率汇率系统 通过esb传给 summit系统的市场数据文件名   是 IR_FXRATE_YYMMDD.txt(自贸区资金)、IR_RATE_YYMMDD.txt(总行资金)，
利率汇率系统 通过esb传给 summit系统的定盘利率数据文件名是 REFRATE_YYMMDD.xml、INTRATE_YYMMDD.xml、ISDAFLBK_YYMMDD.xml

------------------------------

## 20210814 Sat

MktRawHo2Rfr.sh
MktRawHo2Rfr_ImpZeroCurve.sh
MktRawHo2Rfr_ImpMktRates.sh
MktRawHo2Rfr_ExpMktDate.sh
MktRawHo2Rfr_ExpIRRicExt.sh

MktRawFTUS2Rfr_ImpZeroCurve.sh
MktRawFTUS2Rfr_ImpMktRates.sh
MktRawFTUS2Rfr_ExpMktDate.sh

MktRawHk2Rfr_ImpZeroCurve.sh
MktRawHk2Rfr_ImpMktRates.sh
MktRawHkRfr_ExpMktDate.sh

ImportMktRateRFR_start.bat
ImportMktRateRFR.sh


------------------------------

## 20210815 Sun

1.编译xerces，获得dll文件和lib文件
2.将dll文件和lib文件拷贝到使用xerces的工程目录里面去
3.配置VS2017

　　C/C++  ->  All Options -->Additional Include Directories  放入xerces工程的src目录
　　Linker   ->  All Options -->Additional Dependencies 放入lib文件名
　　Linker   ->  All Options -->Additional Library Directories 放入$(OutDir)

5.包含头文件
6.加上命名空间
　XERCES_CPP_NAMESPACE_USE


------------------------------

## 20210816 Mon

CDB: flowmtmadapter: Tradeid


以Oracle 用户登录Linux启动Oracle:sqlplus quot;scott/tiger as sysdbaquot; startup进入sqlplus以后：以要导入、导出到xzfw
以Oracle 用户登录Linux
启动Oracle:
sqlplus "scott/tiger as sysdba"
startup
进入sqlplus以后：以要导入、导出到xzfw为例。
必须有/Oracle/oradata/xzfw的写入权限：才可以进行如下操作.
创建表空间：
create tablespace xzfw(表空间名：自己命名) logging datafile '/Oracle/oradata/xzfw(和前边xzfw一致，/Oracle/oradata目录必须存在而且有写入权限)' size 200M autoextend on next 50M extent management local segment space management auto;
创建用户和密码：
create user xzfw(用户名) identified by "sa" default tablespace xzfw(表空间名) temporary tablespace TEMP profile default quota unlimited on users;
添加用户授权：
grant dba,connect,resource,aq_administrator_role,aq_user_role,authenticateduser to xzfw(表空间名);
退出sqlplus，在Oracle用户登录下：
(导入备份)imp xzfw/sa file=/home/Oracle/xzfw.dmp fromuser=xzfw(这个是当时导出数据时Oracle的用户名) ignore=y
(导出备份)exp xzfw/sa file=/home/Oracle/xzfwbk.dmp owner=xzfw
开启Oracle监听：
lsnrctl
start

------------------------------

## 20210817 Tue

CDB: flowmtmadapter: ctrdmap

Oralce数据库导出(expdp)、数据库导入(impdp)

一. 导出工具 exp
1. 它是操作系统下一个可执行的文件 存放目录/ORACLE_HOME/bin
exp导出工具将数据库中数据备份压缩成一个二进制系统文件.可以在不同OS间迁移
它有三种模式：
a.  用户模式： 导出用户所有对象以及对象中的数据；
b.  表模式： 导出用户所有表或者指定的表；
c.  整个数据库： 导出数据库中所有对象。
2. 导出工具exp交互式命令行方式的使用的例子：
$exp test/test123@appdb
Enter array fetch buffer size: 4096 > 回车
Export file: expdat.dmp > m.dmp  生成导出的文件名
(1)E(ntire database), (2)U(sers), or (3)T(ables): (2)U > 3
Export table data (yes/no): yes > 回车
Compress extents (yes/no): yes > 回车
Export done in ZHS16GBK character set and ZHS16GBK NCHAR character set
About to export specified tables via Conventional Path ...
Table(T) or Partition(T:P) to be exported: (RETURN to quit) > cmamenu  要导出的表名
. . exporting table                        CMAMENU       4336 rows exported
Table(T) or Partition(T:P) to be exported: (RETURN to quit) >要导出的表名n
Table(T) or Partition(T:P) to be exported: (RETURN to quit) > 回车
Export terminated successfully without warnings.
导出命令：
复制代码代码如下:
exp test/test123@orcl file=/opt/daochu.dmp full=y
其中test是用户名称，后一个test123是用户密码，orcl是数据库名称，file是存放要导出文件的url
二.导入工具 imp
1. 它是操作系统下一个可执行的文件 存放目录/ORACLE_HOME/bin
它有三种模式：
a.  用户模式： 导入用户所有对象以及对象中的数据；
b.  表模式： 导入用户所有表或者指定的表；
c.  整个数据库： 导入数据库中所有对象。
只有拥有IMP_FULL_DATABASE和DBA权限的用户才能做整个数据库导入
imp步骤：
(1) create table  (2) insert data  (3) create index (4) create triggers,constraints
2.导入工具imp交互式命令行方式的例子：
$ imp
Import: Release 8.1.6.0.0 - Production on 星期五 12月 7 17:01:08 2001
(c) Copyright 1999 Oracle Corporation.  All rights reserved.
用户名:  test
口令:****
连接到: Oracle8i Enterprise Edition Release 8.1.6.0.0 - 64bit Production
With the Partitioning option
JServer Release 8.1.6.0.0 - Production
导入文件: expdat.dmp> /tmp/m.dmp
输入插入缓冲区大小（最小为 8192 ) 30720>
经由常规路径导出由EXPORT:V08.01.06创建的文件
警告: 此对象由 TEST 导出, 而不是当前用户
已经完成ZHS16GBK字符集和ZHS16GBK NCHAR 字符集中的导入
只列出导入文件的内容(yes/no)：no>
由于对象已存在, 忽略创建错误(yes/no)：no> yes
导入权限(yes/no)：yes>
导入表数据(yes/no)：yes>
导入整个导出文件(yes/no)：no> yes
. 正在将TEST的对象导入到 SCOTT
. . 正在导入表                       "CMAMENU"       4336行被导入
成功终止导入，但出现警告。
导入命令：
复制代码代码如下:
$imp test/test123@orcl file=/opt/whufe.dmp full=y
其中test是用户名称，后一个test123是用户密码，orcl是数据库名称，file是存放要导入文件的url
希望本文所述对大家Oracle数据库程序设计有所帮助。

------------------------------


## 20210818 Wed


CDB: ZeroCurveImport: bat to shell

select to_char((last_day(to_date(to_char(sysdate,'mm')-1,'mm'))+1),'yyyy-mm-dd') as startday,to_char(last_day(sysdate),'yyyy-mm-dd') as lastday from dual;

--更新表te_m_recheck_info ，如果表te_m_recheck_info 存在记录AAA 则执行更新操作，否则执行insert操作

merge into te_m_recheck_info m--该表是需要更新或插入的表  
using te_m_manualalert_info_new bb -- 关联表  
on (m.s_manualertid ='AAA')--这种方式比较安全，给出 指定条件进行匹配
--( m.s_manualertid = bb.s_manualertid) --也可使用该语句进行全表关联（ 小心会更新全表数据）  
when matched then --匹配关联条件，作更新处理  
   update set m.c_depetype=bb.c_depetype --可以多个值进行更新，用逗号分隔开（同Sql中的Update后的set写法）
 where m.s_manualertid='AAA' and bb.s_manualertid = 'AAA'   --两张表同时存在AAA时才进行更新
when not matched then --不匹配关联条件，作插入处理。 
  insert
  values
    ('a',
     bb.s_manualertid,
     to_date('2018-04-03 12:00:00','yyyy-MM-dd hh24:mi:ss'),
     'a',
     'a')
     where bb.s_manualertid='2b5d80e5-3153-44eb-a85d-7f0116071c80'

------------------------------


## 20210819 Thu


CDB: IRRicExportExt: recompile

一个几万级的表，取名为tabel1，有字段id,years,money,其中years=2016,想把tabel1的years修改为2015，其他不变，然后把这些数据再追加到tabel1中。

开始采取的方法是将tabel1的数据导出到tabel1.sql中，然后手工修改years为2015，再insert到表中，但是由于数据过多，很费时间，所以开始寻找更好的方法，下面的方法只要几秒就可以，由此可见，对同一个问题不同的方法有很大的优劣区别。以后遇问题要勤思考是否有更好的解决方法。


**  insert into tabel t1 (t1.id,t1.years,t1.money) select t2.id,'2015',money from tabel t2 where t2.years = '2016' ;


merge into bonuses d 
using (select employee_id, salary, department_id from employees 
where department_id = 80) s 
on (d.employee_id = s.employee_id) 
when matched then update set d.bonus = d.bonus + s.salary*.01 
when not matched then insert (d.employee_id, d.bonus) 
values (s.employee_id, s.salary*0.01); 

存在则更新，不存在则插入
MERGE into TEST a using (select * from TEST) b  on (a.id = b.id) 
    when matched then    //如果存在
      update TEST set NAME='BB' 
    when not matched then
      insert into TEST (ID,NAME) VALUES (1,'AA');
	  
	  

------------------------------


## 20210820 Fri

CDB: import mktdata: merge shell 

a="indv1"
indv1="Sus1"
eval tmp='$'$a
echo $tmp  //Sus1

------------------------------


## 20210821 Sat

去除空行
cat 文件名 |tr -s ‘\n'
cat 文件名 |sed ‘/^$/d'
cat 文件名 |awk ‘{if($0!=”")print}'
cat 文件名 |awk ‘{if(length !=0) print $0}'
grep -v “^$” 文件名

逐行打印时再加上一个空行
sed '/^$/d' input | awk '{print $0"\n"}' >output


合并空行
cat -s urfile

cat -A a.txt
awk '{if($0 != ""){print NR,$0} else {print $0}}' a.txt   ## 给非空行加上行号
awk '{if($0 != ""){print NR,$0} else {print $0}}' a.txt |uniq  ## 对所有行去重
awk '{if($0 != ""){print NR,$0} else {print $0}}' a.txt |uniq|cut -d " " -f 2-  ## 删除行号

sed -n l a.txt
sed 's/^\s*//g' a.txt |sed -n l  ## 删除行首的空格和制表符
sed 's/^[\t ]*//g' a.txt | sed -n l  ##删除行首的空格和制表符

sed 's/^\s*//g' a.txt | cat -A  ## 删除行首的空格和制表符
sed 's/^\s*//g' a.txt | awk '{if($0 != ""){print NR,$0} else {print $0}}'|uniq  ##将多个空行合并为一个空行
sed 's/^\s*//g' a.txt | awk '{if($0 != ""){print NR,$0} else {print $0}}'|uniq | cut -d " " -f 2-


sed -n '/^\s*$/p' a.txt | sed -n "$="   ## 统计空行的数目
sed -n '/^[\t ]*$/p' a.txt | wc -l      ## 统计空行的数目

n=$(sed -n '/^[\t ]*$/p' a.txt | wc -l)
let a=n/2    ## 取循环的次数
for i in `seq $a`; do sed '/^\s*$/{n;/^\s*$/d}' a.txt -i; done  ## 删除空行

sed '/^$/N;/^\n$/D' file


------------------------------



## 20210822 Sun

删除文件的倒数第1行到倒数第5行的数据
获取文件的名
file_name=$1
找到该文件所在的路径
file_path=`find ~  -type f -name $file_name`
echo '该文件的路径为:'$file_path
line_num=`cat $file_path |wc -l`

wc -l 从0开始计数
let line_num++  
echo '该文件的行数为：'$line_num
 
a=$[$line_num-5]
b=$[$line_num-1]
 
echo '起始行为：'$a
echo '末尾行为：'$b
 
sed -i "${a},${b}d" $file_path
 


获取特定两个字符之间的内容
cut -d '=' -f 2 file | cut -d '"' -f 1

cat file | sed -n '/startup nomount/,/startup nomount/{//!p}'
cat file | sed -n '/startup nomount/,/startup nomount/{p}'  
sed删除两行之间的内容
$ cat test
1
start
2
end
3


$ sed -n '1,/start/p;/end/,$p' test
1
start
end
3


$ sed '/start/,/end/d' test
1
3

1、删第一行
sed -i '1d' id.txt
2、删指定两行中间内容
sed -i '1,100d' id.txt
3、删除最后一行：
sed -e '$d' file
4、删除带有string的行
sed -i '/^love/d' file
sed -i '/love/d' file



------------------------------


## 20210823 Mon

CDB: flowmtmadapter: DaysGap

关于投资活动中的一些常识
一、投资回报率
1、国债回报率 4%，银行固定收益理财也这水平。
2、打理社保基金的就是只能赚不能亏的高手，长期年化是 8%。
3、社会各行业平均回报率 8%，这也是现金流折现模型中经常使用 8% 来折现的原因。
4、公募基金经理长期年化超过 15% 的只有 10 人，年化超过 10% 的有 60 人。
5、公募基金经理长期年化收益超过 20% 只有 1 人，他 4 年的年化 21%。
6、巴菲特年化 22% 即 60 年回报 15 万倍，78 年 544 万倍。做得早、稳得赚、活得久。
7、承诺 8% 以上固定收益的理财产品要做好本金全部损失的打算，因为加上销售费、行政费及盈利，至少 16 个点以上了。长期能赚 16% 的业务非常少，而且能赚这么多的公司可以直接拿 5% 以下的正规资金，为什么要拿你 16% 以上的资金呢？
小结：对基金经理，长期 20% 的收益率是很难逾越的坎。
二、公司收益增长
1、长期年化 10% 的公司已经很厉害，加上现金分红多，也容易出牛股。
2、长期年化 20% 的公司绝对是高增长，真正的大牛股很多在此。
3、那种 30% 或者 50% 以上增长的公司增长率会下降，如果一直持续，要么是难得一见的天才公司，要么是造假。
4、不要轻易相信那些增长率超过 50% 的公司，要么是一次性的新增产能投放，更有可能是过去基数太低。
小结：对实业公司，长期 20% 的收益增长是很难逾越的坎。
三、账面净利润
1、报表上列出的净利润不是真正的净利润，因为会计手段的可操作性，要用现金流去验证。
2、报表上的经营现金流净值也不是实际的经营现金流，因为可能涉及应收应付银行承兑汇票，以及记在投资现金流中的属于经营性质的日常资产维护费用。
小结：以账面净利润算得出低 PE 倍数，以账面的经营净现金流去判断净利润质量高，很可能导会致错误的投资决策。
芒格说：所谓常识，是平常人没有的常识。我们在说某个人有常识的时候，我们其实是说，他具备平常人没有的常识。人们都以为具备常识很简单，其实很难。
拥有常识不但意味着有能力分辨智慧，也意味着有能力拒绝愚蠢。如果排除了许多事情，你就不会把自己搞得一团糟。

------------------------------


## 20210824 Tue

CDB: import mktdata: 56FTUS to 62RFR


   for ( i = 0; i < Trades->List.ItemsUsed; i++ )
   {
      if ( !( trade = (sTRADE*)sGetListItem( (void*)Trades, i )))
      {
         sLogMessage("Error extracting trade", sLOG_ERROR, 0);
         return( sERROR );
      }

      memset ( (char*) &stats, 0, sizeof(sSTATS) );

      if ( sValueTrade( &stats, NULL, NULL, trade, NULL, sBaseCcy(), NULL,
           sAppDate(), 00, 00, 00 ))
      {
         sLogMessage("Error valuing trade", sLOG_ERROR, 0);
         return( sERROR );
      }

      /* Format the value amount into a string */

      sExtFormatAmount( buf, stats.Value, 15, sUNITS, sBRACKETS, sFALSE );
      printf( "\t%s\t\t%s\n", trade->Base.TradeID.Num, buf );

      npv += stats.Value;
   }


      if( sSUCCESS != sEntityDBWrite( newFrmtDocEnt, (void*)oldFrmtDoc, 00 ))
      {
	 sprintf( msg, "Error writing to dmFORMATTED_DOC (DocumentId:%s).", documentId );
	 printf( msg );
	 return( sERROR );
      }


------------------------------

## 20210825 Web

CDB: cpcurves: 62RFR -SKIPI EONIA





------------------------------


## 20210826 Thu

CDB: export mktdata: add CNY,CNH,HKD,USD

3.2	接口开发和技术测试	进行中	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	接口1：Sum2Sum STP Server		05/31/2021	06/30/2021	邹长根
	接口2：Sum2Sum Utility		07/01/2021	07/07/2021	邹长根
	接口3：Sum2Sum Adapter/Loader		05/31/2021	06/30/2021	陆侃
	接口4：Flow Export STP Server		07/01/2021	07/15/2021	邹长根
	接口5：FlowMTM Gen Utility		07/15/2021	07/21/2021	邹长根
	接口6：FlowMTM Import Utility		07/01/2021	07/15/2021	陆侃
	接口7：Zero Curve Export Utility		05/31/2021	06/10/2021	黄文荣
	接口8：Zero Curve Import Utility		06/10/2021	06/11/2021	黄文荣
	接口9：SWAP Transition Adj function		07/01/2021	07/15/2021	邹长根/陆侃
3.3	GUI交易界面开发和技术测试	未开始	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	SWAP/MM/CAP/FLOOR Asset Detail 開發		06/14/2021	06/30/2021	黄文荣
	Bond Definition Asset Detail 開發		06/14/2021	06/30/2021	黄文荣
	SWAP Transition功能		06/14/2021	06/30/2021	黄文荣
3.4	报表开发和技术测试	未开始	05/31/2021	06/30/2021	邹长根/陆侃/黄文荣
	Rate Reset Missing Report		07/01/2021	07/15/2021	黄文荣
3.5	批量脚本调整和技术测试	未开始	07/01/2021	07/15/2021	邹长根/全睿/Ray Huang
	總行/港行/自貿區腳本調整		07/01/2021	07/15/2021	黄文荣/全睿
	Summit RFR腳本開發		07/01/2021	07/15/2021	黄文荣/全睿
3.6	技术文档编写	未开始	07/16/2021	07/19/2021	邹长根/陆侃/黄文荣

ZeroCurveExport接口开发--代码编写/编译/技术验证/解决xxx问题等待
程序代码

RFR零息利率曲线: 
当前是：1套62环境，一次性分别导出3套56生产环境（总行1，自贸区1，港行3）共5个文件？（之后再各自导入到对应生产环境总行1/自贸区1/港行3）

B.分别在总行62环境、自贸区62环境，港行62环境各自导出文件（1+1+3）？

Ccy  Index  Curve ID  

RFRHO .
RFRHK
RFRFTZ 

10.5.128.119

因为外汇类产品之前都是根据USD LIBOR来推算隐含利率曲线（见下图红框），为了保持估值的前后一致性，替换前用LIBOR曲线进行估值，替换后用新的SOFR曲线进行估值，需要将05年至替换LIBOR这段时间的LIBOR曲线复制到SOFR上。 
切换前，生产环境同时接LIBOR和SOFR的市场数据，切换当天需要将切换日当天前的LIBOR市场数据复制到SOFR上，且使用到的CURVE ID都需要复制。切换日当天跑批前风险部手工将生产环境中需要切换的曲线的Interest Rate Curve 中LIBOR改成SOFR。如果上线时不切换，建议分时段将LIBOR Copy到SOFR上，上线时将05年至上线时点的历史LIBOR COPY至SOFR上，切换时将上线时间至切换时间的LIBOR COPY到SOFR上


https://finastra.litmoseu.com/account/Welcome
Pai@314159

星期一 Monday，星期二 Tuesday，星期三 Wednesday，星期四 Thursday，星期五 Friday，星期六 Saturday，星期日 Sunday

January、February、March、April、May、June、July、August、September、October、November、December.

cpp -v /dev/null -o /dev/null



------------------------------



## 20210827 Fri

CDB: IRRicExportExt: interface docs

certutil -hashfile 'C:/Users/u726334/OneDrive - Finastra/文档/Working/notes/c/c1.cc' MD5

*/2 * * * * root /home/bin/impTimer.sh >/dev/null 2>&1
*/2 * * * * root /root/home/bin/impTimer.sh >>/root/home/log/impTimer.log  2>&1


service crond start //启动服务 
service crond stop //关闭服务 
service crond restart //重启服务 
service crond reload //重新载入配置

查看crontab服务状态：service crond status 
手动启动crontab服务：service crond start 

at -f test-cron.sh -v 10:25 

[ -f t2.log ] && [ -r t2.log ]

ls -l t2.log | awk '{print $8}'

ls -l --time-style=iso

stat t2.log

echo "$((3600/3600)):$((3600%3600/60)):$((3600%3600%60))"

date -d "2015-08-04 00:00:00" +%s  #1438617600
date -d @1623590767  "+%Y-%m-%d %H:%M:%S"    #2021-06-13 21:26:07

date +%s  #1623592867

date "+%Y-%m-%d %H:%M:%S"  #2021-06-13 22:04:16

awk 'BEGIN{printf "%.2f%%\n",(87/500)*100}' #17.40%
awk -v a=1 -v b=3 '{printf("%.4f",a/b)}'

c=`echo | awk -v a=1 -v b=3 '{printf("%.4f",a/b)}'`
echo $c

cat oldfiles.log | grep $newfile >/dev/null

$(cat ./tmp)

while read LINE
do
echo $LINE
done < $FILENAME

for i in  `cat $FILENAME`
do
echo $i
done

[ -z "$file1" ] && echo 1 ||echo 0


echo ${a2:0:32}

md5sum linuxmint-12-gnome-dvd-32bit.iso|cut -d ' ' -f1
md5sum linuxmint-12-gnome-dvd-32bit.iso >linuxmint-12-gnome-dvd-32bit.md5

md5sum -c linuxmint-12-gnome-dvd-32bit.md5
echo -n 'hello'|md5sum|cut -d ' ' -f1

md5sum RFRHO.dat|cut -d ' ' -f1


a2=$(echo `md5sum -c RFRHO.md5 |cut -d ' ' -f1`)

|cut -d ' ' -f1
|cut -d ' ' -f1

如果脚本在windowns环境下编辑，需要将脚本转化为unix格式
sed -i "s/\r$//" /home/hive/*.sh

"clang.cflags": [
"-I${workspaceRoot}/dev"
]

$ g++ test.cpp -lpthread -o test.o
identifier not found

#include <cstdio> 
assignment within conditional expression 



------------------------------

## 20210828 Sat

static_import

summit_export -ENT CUSTOMER -SQL "where dmCUSTOMER.Audit_Current = 'Y' and dmCUSTOMER.cdmIssuer = 'Y' " -XML -O D:\summit\Out\CUSTOMER.xml   

<ConfirmReq>Y</ConfirmReq>  45
<PaymentReq>Y</PaymentReq>  91

CUSTOMER/ConfirmReq
CUSTOMER/ConfirmReq
//summit_customer/CUSTOMER/ConfirmReq

CUSTOMER/PaymentReq
CUSTOMER/PaymentReq
//summit_customer/CUSTOMER/PaymentReq

1 #include <xercesc/util/PlatformUtils.hpp>
2 #include <xercesc/dom/DOM.hpp>
3 #include <xercesc/sax/HandlerBase.hpp>
4 #include <xercesc/parsers/XercesDOMParser.hpp>



------------------------------


## 20210829 Sun

#include <stdio.h>
#include <string>
#include <vector>
#include <iostream>

// #include <iostream>

using namespace std;

void SplitString(const string &s, vector<string> &v, const string &c);
int getFileMD5(string strFpath, string &strMD5);
int writeMD5(string &strMD5, string &strPath, string &strfile, string &strFileMd5);

int main()
{
	string strMD5;
	string strMD5File = "MD5.txt";
	string strPath = "C:/notes/c";
	string strFile = "RFRHO.txt";
	string strFpath = strPath + "/" + strFile;

	string strFileMd5 = "RFRHO.md5";

	getFileMD5(strFpath, strMD5);
	writeMD5(strMD5, strPath, strFile, strFileMd5); // strMD5File  strFileMd5

	cout << "strMD5: " << strMD5 << " strFile: " << strFile << endl;

	return 0;
}

void SplitString(const string &s, vector<string> &v, const string &c)
{
	string::size_type pos1, pos2;
	pos2 = s.find(c);
	pos1 = 0;
	while (string::npos != pos2)
	{
		v.push_back(s.substr(pos1, pos2 - pos1));

		pos1 = pos2 + c.size();
		pos2 = s.find(c, pos1);
	}
	if (pos1 != s.length())
		v.push_back(s.substr(pos1));
}

int getFileMD5(string strFpath, string &strMD5)
{
	string cmd = "certutil -hashfile  \""; //chcp 65001 &&
	cmd += strFpath + "\" MD5";

	string strBuf;

	
	FILE *pipe = popen(cmd.c_str(), "r");
	if (!pipe)
		return 0;
	char buffer[128] = {0};

	while (!feof(pipe))
	{
		if (fgets(buffer, 128, pipe))
			strBuf += buffer;
		// strcat(strMD5, buffer);
	}
	pclose(pipe);

	vector<string> vBuf;
	SplitString(strBuf, vBuf, "\n"); //可按多个字符来分隔;


	strMD5 = vBuf[1];

	// for (vector<string>::size_type i = 0; i != vBuf.size(); ++i)
	// 	cout << i << vBuf[i] << " " << endl;

	return 0;
}

int writeMD5(string &strMD5, string &strPath, string &strfile, string &strFileMd5)
{
	string strMD5Path = strPath + "/" + strFileMd5;
	FILE *fp = fopen(strMD5Path.c_str(), "w");
	if (fp == NULL)
	{
		printf("文件不存在，结束");
		exit(0);
	}
	else
	{
		// printf("\n%s \t%s \t%s\n", strMD5.c_str(), strMD5Path.c_str(), strfile.c_str());
		fprintf(fp, "%s\t%s\n", strMD5.c_str(), strfile.c_str());
	}

	return 0;
}


------------------------------

## 20210830 Mon

CDB: export mktdata: add CNY,CNH,HKD,USD


安装 .NET CORE SDK.  dotnet-sdk-5.0.301-win-x64.exe
生成和文件夹名字相同的项目 dotnet new console
dotnet restore 编译项目  生成项目，dotnet build
运行项目，dotnet run
命令行 dotnet help  dotnet new 可以查看帮助

dotnet new mvc -n MvcDemo
发布项目，dotnet publish -f netcoreapp1.1 -c Release





#!/bin/bash

current=`date "+%Y-%m-%d %H:%M:%S"`
timeStamp=`date -d "$current" +%s`
currentTimeStamp=$((timeStamp*1000+`date "+%N"`/1000000)) 

echo $current : $currentTimeStamp : impTimer 2 world : $RANDOM

------------------------------


## 20210831 Tue

CDB: IRRicExportExt: interface docs

#!/bin/bash

FILE_PATH=/home/at/data/
FILE_NAME_RFRHO=RFRHO.dat
FILE_NAME_RFRHK=RFRHK.dat
FILE_NAME_RFRFTZ=RFRFTZ.dat
FILE_NAME_RFRMD5=RFRMD5.txt

if [[ -f $FILE_PATH$FILE_NAME_RFRHO ]]; then

    MD5_RFRHO=$(echo `md5sum $FILE_PATH$FILE_NAME_RFRHO`)
    MD5_RFRHO=${MD5_RFRHO:0:32}

    if [[ -z ${MD5_RFRHO} ]]; then

        echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRHO.dat文件MD5值为空, 无法校验"
    fi
else
    echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRHO.dat文件不存在, 无法校验">>/home/at/test/log/t2.log
fi

if [[ -f $FILE_PATH$FILE_NAME_RFRHK ]]; then

    MD5_RFRHK=$(echo `md5sum $FILE_PATH$FILE_NAME_RFRHK `)
    MD5_RFRHK=${MD5_RFRHK:0:32}

    if [[ -z ${MD5_RFRHK} ]]; then

        echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRHK.dat文件MD5值为空, 无法校验"
    fi
else
    echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRHK.dat文件不存在, 无法校验">>/home/at/test/log/t2.log
fi

if [[ -f $FILE_PATH$FILE_NAME_RFRFTZ ]]; then

    MD5_RFRFTZ=$(echo `md5sum $FILE_PATH$FILE_NAME_RFRFTZ `)
    MD5_RFRFTZ=${MD5_RFRFTZ:0:32}

    if [[ -z ${MD5_RFRFTZ} ]]; then

        echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRFTZ.dat文件MD5值为空, 无法校验"
    fi
else
    echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRFTZ.dat文件不存在, 无法校验">>/home/at/test/log/t2.log
fi

# echo '$MD5_RFRHO'  $MD5_RFRHO
# echo '$MD5_RFRHK'  $MD5_RFRHK
# echo '$MD5_RFRFTZ' $MD5_RFRFTZ

if [[ -f $FILE_PATH$FILE_NAME_RFRMD5 ]]; then

    # echo `date "+%Y-%m-%d %H:%M:%S"` "文件存在"

    for i in  `cat $FILE_PATH$FILE_NAME_RFRMD5`
    do  
        if [[ -n $MD5_RFRHO  && $i == $MD5_RFRHO ]]; then
            
            echo '$i == $MD5_RFRHO mktimp'  $i

        elif [[ -n $MD5_RFRHK  && $i == $MD5_RFRHK ]]; then

            echo '$i == $MD5_RFRHK mktimp'  $i

        elif [[ -n $MD5_RFRFTZ  && $i == $MD5_RFRFTZ ]]; then

            echo '$i == $MD5_RFRFTZ mktimp'  $i

        fi
    done
else

    echo `date "+%Y-%m-%d %H:%M:%S"` "ZeroCurve导入报错:" "RFRMD5.txt文件不存在, 无法校验">>/home/at/test/log/t2.log
fi

------------------------------

# 202109 

------------------------------

## 20210901 Web

CDB: flowmtmadapter: 56HO extprice error analysis

EXTRALIBLIBS=

all_target($(SUMMITEXE)/$(EXE))
 
SERVERLIBS=

orbix2k_build_object_files()
orbix2k_build_exe($(EXE), $(MAINOBJ), $(STKCCINC), $(CCREPLDFLAGS), $(CCREPLIBS) $(SERVERLIBS) $(LIBXMLLIB) $(LIBXML) )
set_RCS()

phoenix=yes

GUI交易界面是62系统？还是56系统？ 需求文档？谢谢


for var in item1 item2 ... itemN
do
    command1
    command2
    ...
    commandN
done

sum=0
for num in 1 2 3 4;do
    re=${num}%2
    if (( ${re} == 1 ));then
        sum=$[${sum}+${num}]
    fi
done
echo ${sum}

break ：跳出总循环
continue：跳出当前循环，继续下一次循环


------------------------------


## 20210902 Thu

CDB: RefRateCopy: 56HO RefRate restore

[总行SGD]
Ccy6=SGD
Index6=SORA
IRCD6=MM+AVA
CurveID6=RFRHO
Ccy5=SGD
Index5=SORA
IRCD5=ZERRO
CurveID5=MASTER
[总行USD]
Ccy6=USD
Index6=SORF
IRCD6=MM+AVA
CurveID6=RFRHO
Ccy5=USD
Index5=SOFR
IRCD5=ZERO


@REM chcp 65001
set rfrPath=c:\notes\bat
set rfrmd5Name=RFRMD5.txt
set rfrmd5fp=%rfrPath%\%rfrmd5Name%

if exist %rfrmd5fp% (
    for /f "tokens=1,2 delims= " %%i in (%rfrmd5fp%) do (
        if exist %rfrPath%\%%j (
            @REM echo %%i %%j
            for /f "skip=1 delims=" %%k in ('certutil -hashfile "%rfrPath%\%%j"  MD5') do (
                if %%i == %%k (
                    @REM call env.bat &  mktimp -i %rfrPath%\%%j
                )
            ) 
        ) else (
            echo Import Error : %rfrPath%\%%j no exist, please check it!
        )
    )	
) else (
    echo Import Error : %rfrmd5fp% no exist, please check it!
)


for /f "tokens=1-16" %%a in ('CertUtil -hashfile %1 MD5^|findstr /v "CertUtil MD5"') do echo/%%a%%b%%c%%d%%e%%f%%g%%h%%i%%j%%k%%l%%m%%n%%o%%p




javascript:;

------------------------------



## 20210903 Fri

CDB: flowmtmadapter: swap ExtTradeId blank

Bond Definition	Asset detail
Bond Trade	Main
Swap, MM, IRG Trade	Asset detail (please consider multiple legs)


@REM chcp 65001
@REM call d:\output\md5env.bat
@REM call d:\sumapps\tools\Orbix63\SummitCs01\orbix633\etc\bin\orbix633_env.bat

@ehco off
@call "D:\summit\SMT\env\etkws_env.bat"


@set rfrPath=d:\input
@set rfrmd5Name=RFRMD5.txt
@set rfrmd5fp=%rfrPath%\%rfrmd5Name%
@set sp= 

@if exist %rfrmd5fp% (
    @for /f "tokens=1,2 delims=%sp%" %%x in (%rfrmd5fp%) do (
        @if exist %rfrPath%\%%y (
            @for /f "tokens=1-16 delims= " %%a in ('certutil -hashfile "%rfrPath%\%%y"  MD5') do (
                @if %%x == %%a%%b%%c%%d%%e%%f%%g%%h%%i%%j%%k%%l%%m%%n%%o%%p (
					
                    @REM mktimp -i %rfrPath%\%%y
					@echo ---%date% %time%---%%x---333---
					@call choice /t 1 /d y /n >nul
                )
            ) 
        ) else (
            @echo Import Error : %rfrPath%\%%y no exist, please check it!
        )
    )
) else (
    @echo Import Error : %rfrmd5fp% no exist, please check it!
)


srand((int)time(NULL));
int n = rand() % 1000000;







------------------------------

## 20210904 Sat

EnumVal
EnumVal	ShortName	No Space and contain all capital letters. ShortName should be identical to Symbol.	cXXXX when extending Summit datatype. No restriction otherwise.
	CName	sXXX_YYYY. XXX is two- or three-letter codes uniquely identify the enumeration. YYYY represents the enumerated value name.	cXXX_YYYY. XXX is two- or three-letter codes uniquely identify the enumeration. YYYY represents the enumerated value name.

#她的微笑 #五月雨#告白之夜 #穿越时空的思念 last reunion

mktimp导入

    FILE *fp; 
    fp=fopen("ZeroCurve.txt","w"); 
    if(fp==NULL){ 
        printf("Error, 文件不存在，结束!");
        exit(0);
    }
    else{

        char  aCCY[20], aINDEX[20], aID[20], aDATE[20]; // sTEXT20_LEN

        strcpy( aCCY, "USD" );
        strcpy( aINDEX, "SOFR" );
        strcpy( aDATE, "4/2/2021" );
        strcpy( aID, "MASTER" );
        strcpy( aCCY, "USD" );

// CCY USD
// INDEX SOFR
// DATINDEXE 4/2/2021
// ID MASTER
// USD SOFR ZERO

// 1/20/1997 0.709701522795
// 1/21/1997 0.709701522795
// 1/30/1997 2.036539981528
// 2/25/1997 2.385908288716
// 4/23/1997 2.755504614461
// 1/23/1998 2.846573810299
// 1/25/2000 2.961601436523

        vector<string> vStr1;
        vector<vector<string>> vZeroIR;

        vStr1.push_back("1/20/1997");
        vStr1.push_back("0.709701522795");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("1/21/1997");
        vStr1.push_back("0.709701522795");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("1/30/1997");
        vStr1.push_back("2.036539981528");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("2/25/1997");
        vStr1.push_back("2.385908288716");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("4/23/1997");
        vStr1.push_back("2.755504614461");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("1/23/1998");
        vStr1.push_back("2.846573810299");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        vStr1.push_back("1/25/2000");
        vStr1.push_back("2.961601436523");
        vZeroIR.push_back(vStr1);
        vStr1.clear();

        fprintf(fp,"CCY %s\n", aCCY);
        fprintf(fp,"INDEX %s\n", aINDEX);
        fprintf(fp,"DATE %s\n", aDATE);
        fprintf(fp,"ID %s\n", aID);
        fprintf(fp,"%s %s ZERO\n", aCCY, aINDEX );


        // for (std::vector<std::vector<string> >::iterator i = vZeroIR.begin(); i != vZeroIR.end();) { 
        //     for (std::vector<string>::iterator j = i->begin(); j != i->end(); ) { 
        //         fprintf(fp,"%s", j.c_str());
        //     } 
        //     fprintf(fp,"\n");
        // }

        for(int i=0; i< vZeroIR.size(); i++)
        {
            for(int j=0;j<vZeroIR[i].size();j++)
            {
                if(j==vZeroIR[i].size()-1){
                    fprintf(fp,"%s", vZeroIR[i][j].c_str() );
                }
                else{
                    fprintf(fp,"%s ", vZeroIR[i][j].c_str() );
                }
            }
            
            fprintf(fp,"\n");
        }
 	}

    printf("已输出到文件 ZeroCurve.txt，结束！\n");
    return 0;
}

    ifstream configFile;
    string path = "../conf/setting.conf";
    configFile.open(path.c_str());
    string str_line;
    if (configFile.is_open())
    {
        while (!configFile.eof())
        {
            getline(configFile, str_line);
            if ( str_line.find('#') == 0 ) //过滤掉注释信息，即如果首个字符为#就过滤掉这一行
            {
                continue;
            }    
            size_t pos = str_line.find('=');
            string str_key = str_line.substr(0, pos);
            string str_value = str_line.substr(pos + 1);
            m_mapConfigInfo.insert(pair<string, string>(str_key, str_value));
        }
    }
    else
    {    
        cout << "Cannot open config file setting.ini, path: ";
        exit(-1);
    }

infile.close();

  map<char,int> mymap;
  map<char,int>::iterator it;


// map::clear
#include <iostream>
#include <map>
using namespace std;

int main ()
{
  map<char,int> mymap;
  map<char,int>::iterator it;

  mymap['x']=100;
  mymap['y']=200;
  mymap['z']=300;

  cout << "mymap contains:\n";
  for ( it=mymap.begin() ; it != mymap.end(); it++ )
    cout << (*it).first << " => " << (*it).second << endl;

  mymap.clear();
  mymap['a']=1101;
  mymap['b']=2202;

  cout << "mymap contains:\n";
  for ( it=mymap.begin() ; it != mymap.end(); it++ )
    cout << (*it).first << " => " << (*it).second << endl;

  return 0;
 
int main ()
{
  string str ("There are two needles in this haystack with needles.");
  string str2 ("needle");
  size_t found;

  // different member versions of find in the same order as above:
  found=str.find(str2);
  if (found!=string::npos)
    cout << "first 'needle' found at: " << int(found) << endl;

  found=str.find("needles are small",found+1,6);
  if (found!=string::npos)
    cout << "second 'needle' found at: " << int(found) << endl;

  found=str.find("haystack");
  if (found!=string::npos)
    cout << "'haystack' also found at: " << int(found) << endl;

  found=str.find('.');
  if (found!=string::npos)
    cout << "Period found at: " << int(found) << endl;

  // let's replace the first needle:
  str.replace(str.find(str2),str2.length(),"preposition");
  cout << str << endl;

  return 0;
}

        vector<string> vStr1;
        vector<vector<string>> vZeroIR;

        vStr1.push_back("1/20/1997");
        vStr1.push_back("0.709701522795");

10.5.155.236	Ficdb@Ho155210
10.5.91.60 Ficdb@Ftus9160


developer用：
set serveroutput on;   --确保可以打印输出
declare var2 number;
begin 
var2:=22;
dbms_output.put_line(var2);
end;


pl/sql developer用：
declare var_sql varchar2(200);
begin
var_sql:='good';
DBMS_OUTPUT.PUT_LINE(var_sql);
end;
--或者在定义的时候赋值
declare var_sql varchar2(200):='good';
begin
DBMS_OUTPUT.PUT_LINE(var_sql);
end;

5.1.2


    sCUSBKCD *code;

	for ( int i = 0; i < customer->BkCodeList.List.ItemsUsed; i++ )
	{

		if ( !( code = (sCUSBKCD *)sGetListItem((void *)&customer->BkCodeList, i )))
		{
			sLogMessage("Error getting Bank Code", sLOG_ERROR, 0);
			FreeMemory(custEnt, customer, NULL);
			exit(sERROR);
		}

		printf("--sEntityValidate--customer->BkCodeList.List.ItemsUsed--%d--\n", i);
		sEntityPrint(sGetEntityByName("CUSBKCD"), (void *)code, 00);
	}

char srcValue[32];
strcpy(srcValue , sICEnum("sTERM", curList->char.MCTYPE, sMCTYPE_short));// sLONG_ENUM sSHORT_ENUM
sEditString(srcValue, ..., sNo_LEADING_SPACES|sNO_TRAILINg_SPACES);
printf("MCType :%s\n", srcValue);

sICEnum("sCUST_BUS_ROLE", curList->CustRole, sSHORT_ENUM));



------------------------------


## 20210905 Sun


《自贸区编译环境上线记录表》是用来记录每次上线的程序、代码、配置、脚本等的版本信息，如果以后有上线的需求， 请在这个表里做维护

stkhelp查詢關聯關係

62要取哪條曲線的curve, 然後要導入到56的哪一條curve

56的利率曲線導入用mktimp的指令來做, @R你跟他一起看一下導入的格式, 然後再讓黃文榮寫的代碼取62的curve轉換成導入的格式

smt http://localhost:8090/smt/index.jsp

可以参考这个SOFR.txt，把v62上导出的转换成mktimp 工具使用的文件格式．

从dmCURVECHAR/dmCURVE 拿出数据，转下格式，用mktimp导入就可以

配置文件
導入需要有個程序監控文件和呼叫mktimp導入

ExportZeroCurve.exe 


CCY USD
INDEX SOFR
DATE 4/2/2021
ID MASTER    
USD SOFR ZERO
1/20/1997 0.709701522795
1/21/1997 0.709701522795
1/30/1997 2.036539981528
2/25/1997 2.385908288716
4/23/1997 2.755504614461
1/23/1998 2.846573810299
1/25/2000 2.961601436523

Entity Name , DB Table , Data Struct

string trimmed(const string & data)
{
 int lPos = data.find_first_not_of(' ');
 int rPos = data.find_last_not_of(' ');

 return data.substr(lPos, rPos - lPos + 1);
}

sizeof(a)

接口7：Zero Curve Export Utility		05/31/2021	06/10/2021	黄文荣
接口8：Zero Curve Import Utility		06/10/2021	06/11/2021	黄文荣

Copy USD LIBOR to USD SOFR
 CDB内网OA账号密码今天修改过，  c0131343 / 131343@cDb

”xxx接口开发--代码编写/编译/技术验证/解决xxx问题等待“，或者“修订《方案》中xx章节，xx内容”

Tomcat可能不在运行，无法联系[localhost:8005]（基端口[8005]和偏移量[0]）

window server Tomcat可能不在运行，无法联系[localhost:8005]

BondTradView

V5.6生产环境界面客制化栏位 
SWAP/MM/CAP/FLOOR Asset Detail 开发
Bond Definition Asset Detail 开发
SWAP Transition功能

停止SMT Distribution Server和eToolkit Manager服务
summit_export
定义一下application definition, 在utility 里可以运行就可以
不過你腳本的start date, end date, CCY, CurveID可能需要調整一下
CCY is [%s], Index is [%s], CurveID is [%s]

run_command cdb_cpcurve -X ${startDate} -Y ${endDate} -FROM USD/LIBOR/CLOSING -TO USD/SOFR/MO
	
run_command cdb_cpcurve -X ${startDate} -Y ${endDate} -FROM USD/LIBOR/CLOSING -TO USD/SOFR/CLOSING

有個方法可以解，首先用一個可以繼承的class先繼承後存檔，關閉VS，再Notepad開啟，改成你想繼承的class，再用VS開啟，就可以繼續開發了

sed -i "s/\r$//" /home/hive/*.sh

$CLIENTPATH\metadata\REPOSECBL
convertdb -f cSECB_AcctType.sql.changes .applychanges
genmeta -U $SUMMITDBNAME -P Pass.txt，把v62上导出的转换成mktimp

$CLIENTPATH\metadata\Static_SECBL
static_import -I SECBLBOOKS.xml -XML -NEWACT IMLIVE -UPDACT IMPEDT [-COMMIT]

10.5.156.5
d:\sumapps\client\cdbrfr\src\app
ExportZeroCurve : 62导出zeroCurve数据，56导入，每天8-18时中每小时执行1次
脚本在bat
其中 md5env.bat zerocurveImport.bat 为56环境，zerocurveImport.bat执行 mktimp 环境报错

10.5.156.1
d:\sumapps\cdb5.6.oprod\src\app
cdb_cpcurve : 台湾陈邦旗/ben的项目，执行时需要修改sh脚本的起止日期（开始日期须有数据 MM/DD/YYYY）
脚本在sh


CREATE TABLE Persons( PersonID int, LastName varchar(255), FirstName varchar(255), Address varchar(255), City varchar(255) );

grant connect, resource, dba to 1kSoft;

headset headphones  stereo  w800bt notplugged in

安装 .NET CORE SDK.  dotnet-sdk-5.0.301-win-x64.exe
生成和文件夹名字相同的项目 dotnet new console
dotnet restore 编译项目  生成项目，dotnet build
运行项目，dotnet run
命令行 dotnet help  dotnet new 可以查看帮助

dotnet new mvc -n MvcDemo
发布项目，dotnet publish -f netcoreapp1.1 -c Release


RegisterMethod
ModelDoMethod

assembly


csc helloworld.cs
msbuild helloworld.csproj /t:Build

安装 .NET CORE SDK.  dotnet-sdk-5.0.301-win-x64.exe
生成和文件夹名字相同的项目 dotnet new console
dotnet restore 编译项目  生成项目，dotnet build
运行项目，dotnet run
命令行 dotnet help  dotnet new 可以查看帮助

dotnet new mvc -n MvcDemo
发布项目，dotnet publish -f netcoreapp1.1 -c Release

修改7.4.2的repo、sumrepobal、other
5.3.2repo、sumrepobal、other


– dmENTITY, dmPROPERTY, dmKEYPAIR, dmENTITY_INTERFACE, dmMETHOD, dmDB_INDEX, dmDB_INDEX_COL
– dmINTERFACE_DEF_REC, dmMETHOD_DEF_REC
– dmDATATYPE, dmENUMVAL

shutdown event tracker
other(unplanned)
hardware:maintenance(unpanned)



delivery	交货
sales	销售量
others	其他
attending internal meetings	参加内部会议
attending internal training	参加内部培训
bench	长椅
delivering internal training	提供内部培训
management activities	管理活动
maternity leave	产假
medical leave	病假
non productive travel	非生产性旅行
paid time off	带薪休假
paternity leave	陪产假
project non chargeable	项目不收费
project non chargeable travel	项目不收费旅行
unpaid leave	无薪休假 

Project Non Chargeable
Project Non Chargeable travel

Improve 

#include <stdlib.h>

sEntityPrint( custEnt, (void *)customer, 00 )

sEntityPrint( sGetEntityByName("CUSBKCD"), (void *)code, 00 );



    sDATANODELIST datanode;
    sNODECOMPLIST nodecomp;


    if (sInitList(&messages.List, "sERRMSG"))
    {
        sLogMessage("Error initializing error message list", sLOG_ERROR, 0);
        exit(sERROR);
    }

pricing model definition

FILTER	dmTRADE_FILTER	sTRADE_FILTER
TRADELIST

TRADELIST		sTRADELIST

FXFWD+FXSPOT+FXSWAP

teams machine-wide

Planned Activity	Attending Internal Training
Day	Thu 1
Time Type	Business Day Standard
Entry Hours
8.0000
Notes	Business trip at NBCB ：ft_shchmonitor coding

RepurchaseRate Numerical accuracy maintenance  

RepurchaseRate Numerical accuracy maintenance

AggtFaceAmt Field Analysis(empty) 

7.5
Business trip at NBCB ： coding and git commit/push

Business trip at NBCB ：RepurchaseRate Background Color anomaly analysis

Business trip at NBCB ：Cdcmonitor AggtFaceAmt Field Analysis(empty)

Business trip at NBCB ：Cdcmonitor RepurchaseRate numerical accuracy maintenance

Business trip at NBCB ： Cdcmonitor Cdccommand Analysis

Business trip at NBCB： Cdcmonitor respone(BJ0301_OS03) debug
Business trip at NBCB： Shchmonitor querybond noreply
Business trip at NBCB ： ReutersDataImport import error(255)
Business trip at NBCB ： ReutersDataImport export data analysis(xml)


中国东方航空 MU5168 S 经济舱
宁波 2021-07-16 18:05  北京大兴 2021-07-16 20:25
总价 ： 660 CNY 税 ： 50 CNY

202107152246


Citrix平台开通权限的单子，尾号00517（CD210252）已审批通过；尾号00533（CD210252）已退回，与00517重复；尾号00524已退回，请在服务请求描述中说明需要开通的Citrix账号，避免被运维团队退回

繼續把上次的開發和Ben的開發測試做完

1是安装Citrix ；2是卸载Citrix
http://10.5.128.34/Citrix/DXHDEVWeb/1.exe
http://10.5.128.34/Citrix/DXHDEVWeb/2.exe

跑一次accounting driver, 跑上次的filter, 跑了雖然會掛掉, 但是請@侃侃而谈?或@神龙卷轴?看看summit spool路徑底下的completed.txt內容

CD180027
180027@LDPcdb


cub_extpriceimp 7/5
cdb_cpcurve 6/17

前面加8830 或者 6830    

select * from dmEXT_PRICE_VALUES
select * from dmEXT_INST_VALUES
select * from dmEXTINST_HIST
select * from dmEXTPRICE_HIST 
-UPDATE, 就會replace

若還有同樣的問題, 請把DBLog & 輸出的截圖給我. 若能給有問題的數據PLUPD輸出檔

 数据导入操作正常（入参 MASTER 到 MASTER）

非美元對人民幣都這樣配
use fx points=N，spot=indirect，fwd points=indirect
基本上 spot/fwd 都是要放 indirect 才對。舊版的校驗是有問題的

10.5.156.1  (总行56环境)
10.5.156.3  (自贸区56环境)
10.5.156.4  (港行56环境)

10.5.156.5  RFR62环境

ZeroCurve
CDB ZERO曲线导入

FCI
20151214

 麻烦帮忙提供下project code (7.15, 北京飞大兴机票)？


select * from dmMKTSPEC_HIST
select * from dmMKTDATA_HIST

select m.AsOfDate, s.MktTypeCount
  from dmMKTDATA m
  join (select Hist_Version, dmMktDataId, count(dmSpecNum) as MktTypeCount from dmMKTSPEC
         group by Hist_Version, dmMktDataId) s 
    on m.dmMktDataId = s.dmMktDataId and m.Hist_Version = s.Hist_Version
 where Ccy = 'USD'
   and dmIndex = 'LIBOR'
   and Id = 'MO' 
 order by m.AsOfDate


if exist "e:\mybooks\text.txt" (echo ok ) else (echo err)
if not exist c:\Temp\1.txt goto nofile 

for /F "usebackq tokens=1,2 delims==" %%i in (`wmic os get LocalDateTime /VALUE 2^>NUL`) do if '.%%i.'=='.LocalDateTime.' set ldt=%%j
set ldt=%ldt:~0,4%-%ldt:~4,2%-%ldt:~6,2% %ldt:~8,2%:%ldt:~10,2%:%ldt:~12,6%


@黄文荣?@R?你們確認一下56.4裡面d:\summitapps\cdbhksit\src\app\interface\cr2014017_raterest\ratereset.cc是生產上的版本

1.add the following interest rate curve for rate reset rate
2. export refrate for rfr to xm by summit_export and transfer it to rfr for fixing rate import

測利率就可以了, 就是mktdata轉存到refrate的部

接口11 ， 测试
1.在62环境summit_export导出 refrate 数据/xml ;
2.在56HK环境, 用ratereset导入xml/转成fixing Rate ; 


import_extprice.sh

USD/SOFR，EUR/ESTR，GBP/SONIA，CHF/SARON，JPY/TONA，HKD/HONIA，SGD/SORA

新加坡元
银行同业拆借利率(IBORs) 以指定利率报价银行所提交的数据厘订，为大型银行所广泛采用的利率基准， 包括伦敦银行同业拆借利率(LIBOR)、欧元银行同业拆借利率(EURIBOR) 、欧元隔夜平均利率指数(EONIA)

货币 (Currency)
银行同业拆借利率 (IBORs)
接近无风险利率 (RFRs)
 
美元 (USD)
美元伦敦银行间同业拆借利率(USD LIBOR)
有担保隔夜融资利率 (SOFR)

英镑 (GBP)
英镑伦敦银行间同业拆借利率(GBP LIBOR) (London Inter-Bank Offered Rate, Libor)
英镑隔夜平均指数 (SONIA)

欧元 (EUR)
欧元银行间同业拆借利率(EURIBOR),或
欧元伦敦银行间同业拆借利率(EUR LIBOR)
欧元短期利率(€STR)

日元 (JPY)
日元伦敦银行间同业拆借利率(JPY LIBOR),以及东京银行间同业拆借利率(TIBOR)(分别适用日本在岸和离岸日元)
东京隔夜平均利率(TONA)

瑞士法郎 (CHF)
瑞士法郎伦敦银行间同业拆借利率(CHF LIBOR)
瑞士隔夜平均利(SARON)
 
港元 (HKD)
香港银行间同业拆借利率(HIBOR)
港币隔夜平均利率指数(HONIA)

新加坡元 (SGD)
新加坡银行间同业拆借利率(SIBOR)
新加坡隔夜平均利率(SORA)(Overnight Rate Average, SORA)

澳元 (AUD)
银行票据互换率(BBSW)
澳洲储备银行银行间隔夜现利率(AONIA)

掉期利率(Swap Offer Rate, SOR)

你們確認一下cvid, ccy, index在港行要怎麼新增, 然後要配置到d:\interface\config\fixrate18.ini 和d:\interface\config\fixrate3.ini

window designer layout tool
Windows designer

u726334
Jack Huang	RITM0567265	u726334	Jack.Huang@finastra.com

CDB: ZeroCurveImport: Timing script & Environment variable  
CDB: extpriceimp: Compile & Test
CDB: cdb_cpcurve: Compile & Test
CDB: ZeroCurveImport: ESB & Adapt
CDB: ratereset: 156.4HK Env Config & Test

CDB: stpadapter: 156.1HO Env adapter5.6 adjust & coding 
CDB: stpadapter: 156.1HO Env adapter5.6 import swap.xml & debug
CDB: extpriceimp: Compile & debug
CDB: import: 62Env import ccy static data
CDB: intrate: import intrate data & test

CDB: IRRicExport: add CVID parameter
CDB: IRRicExport: export request file
CDB: flowmtmadapter: Import Swap.xml
CDB: flowmtmadapter: CleanEntityXML
CDB: flowmtmadapter: TradeRemoveTag

CDB: ZeroCurveImport: add new parameter(-COM)
CDB: MarketDataExport: 62FRR Import Script
CDB: MarketDataExport: 56HO Export Script(MKTPOINT)
CDB: ESB Config: 62FRR/56HO/56HK/56FTUS Config
CDB: interface: Recompile & debug 

CDB: flowmtmadapter: Tradeid
CDB: flowmtmadapter: ctrdmap
CDB: ZeroCurveImport: bat to shell
CDB: IRRicExportExt: recompile
CDB: import mktdata: merge shell 
CDB: IRRicExportExt: parameter （-asof）
CDB: flowmtmadapter: longname2
add expense

CDB: flowmtmadapter: DaysGap
CDB: import mktdata: 56FTUS to 62RFR
CDB: cpcurves: 62RFR -SKIPI EONIA
CDB: export mktdata: add CNY,CNH,HKD,USD
CDB: IRRicExportExt: interface docs

CDB: flowmtmadapter: 56HO extprice error analysis
CDB: RefRateCopy: 56HO RefRate restore
CDB: flowmtmadapter: swap ExtTradeId blank

CDB: RefRateCopy: 56HK RefRate restore
CDB: RefRateCopy: 56FTUS RefRate restore
CDB: flowmtmadapter: same & last id 
CDB: cdbEodbetch_archive: import ISBLACK
CDB: index volatility : 56HO export commset

CDB: 56FTZ export static_data
CDB: 56FTZ UAT develop doc
CDB: 56FTZ UAT FT_FRONT install pack 
CDB: 56FTZ UAT complice libstkrtdata
CDB: 56HO execute cpcurve/extprice

CDB: 56FTZ import market data 
CDB: 56HO export history extprice(import_extprice)
CDB: update shell(import data) 
CDB: UAT test data format
CDB: UAT support(import intrate)

CDB: UAT62 support(import libor_rate)
CDB: UAT56 support(import zerocurve EODRISK/EODREVAL)
CDB: UAT56 support(export mktdate asofdate)
CDB: UAT56 support(flowmtmadapter_start)
CDB: UAT56 support(impmktrates_start)

10.8
CDB: UAT 56HO Test mktexp 
CDB: UAT 56 index analysis
CDB: UAT 56FTZ Import/Export Mktdate
CDB: UAT 56FTZ Test REUTERA data
CDB: UAT 56FTZ EodBatch Day Test Mktdate
CDB: UAT 56HO EodBatch Day Test Mktdate
CDB: UAT 56HK EodBatch Day Test Mktdate
CDB: DEV 56FTZ Import/Export Mktdate
CDB: DEV 56HO Import/Export Mktdate
CDB: DEV 56HK Import/Export Mktdate

10.21
CDB: UAT2 56HK Import/Export Mktdate


CDB: UAT 56HO copy refdate 1D 
CDB: UAT 56HO Import/Export Mktdate
CDB: UAT 62RFR cpcurve RFRHO to RFRHK(CNY/REPO) 
CDB: UAT 56HO Import/Export Mktdate
CDB: UAT 56FTZ Import/Export Mktdate

CDB: UAT 56HO Online_Codelist xls
CDB: UAT 56FTZ code doc
CDB: UAT 56HK Code Review xls
CDB: UAT 56HO Code checklist xls
CDB: UAT 56FTZ exe&rollback xls

CDB: UAT 56HO RicEXT test
CDB: UAT batch operation doc
CDB: UAT import filter(trade data)
CDB: UAT Reuters Zero test
CDB: UAT 56HO day batch test

CDB: rfr62 deploy check
CDB: 56HO day batch check
CDB: AllDealsReport test
CDB: esb test doc
CDB: UAT 56HO IRRICEXT code export

11.29
CDB: 56HK day batch check
ABC: Report Test(AgentBank)
ABC: Report Test(Bondinvestinf)
ABC: Report Test(bookstructure)
CDB: deploy support  ABC: Report Test(mktdatarpt)

12.6   3.25
ABC: ASIA Report Test(cBondPRPT_ABCHO)
ABC: ASIA Report Test(CASHFLOWRPT_DB)
ABC: ASIA Report Test(cCustTraderLImitRpt)
ABC: ASIA Report Test(Corporteloaninf)
CDB: HK deploy support 

12.13
ABC: HK extprice test
ABC: ASIA Report Test(fxcostrep)
ABC: ASIA Report Test(FxForwardInf)
ABC: ASIA Report Test(FxOPTInf)
ABC: ASIA Report Test(FxSWAPINF)


ABC: ASIA Report Test(fxplrep)
ABC: ASIA Report Test(GetSplitRate)
ABC: ASIA Report Test(IRSInformation)
ABC: ASIA Report Test(JPYFwdMov)
ABC: ASIA Report Test(LoanInformation)

12.20
ABC: EURO Report Test(ABC_CREDITRIST)
ABC: EURO Report Test(ABC_CTPYCREDR)
ABC: EURO Report Test(BondSheetLus)
ABC: EURO Report Test(BONDINVESTINF)
ABC: EURO Report Test(CASHFLOWER_FFT)

12.27
ABC: EURO Report Test(LUX_CASHFLOW)
ABC: EURO Report Test(MOSCASHFLOW)
ABC: EURO Report Test(checkmktdata)
ABC: EURO Report Test(CorporateLoanInf)
ABC: EURO Report Test(CounterPartyCreditRisk)

2022.1.4--7
ABC: AMER schedule Test(check_monitor)
ABC: AMER schedule Test(check_batch_monitor)
ABC: AMER schedule Test(clean_ERRORLOG)
ABC: AMER schedule Test(EDPDP)

2022.1.10--14
ABC: AMER schedule Test(EndOfDayBatch)
ABC: AMER schedule Test(exportmktdata)
ABC: AMER schedule Test(GetYestday)
ABC: AMER schedule Test(ftp_deal_ticket)
HXB: HxbSit Customer (external application ecif)

2022.1.17--21
HXB: HxbSit Customer (client_CustSyncToty)
HXB: HxbSit Customer (SetCustComment)
HXB: HxbSit Customer (GetNameValue)
HXB: HxbSit Customer (SetCominFlwNo)
HXB: HxbSit Customer (DelNameLabel)

2022.1.24--30
HXB: HxbSit Customer (tongyeCustmerinterface)
HXB: HxbSit Customer (cUpdateCust)
HXB: HxbSit Customer (AddNameLabel)
HXB: HxbSit Customer (CountryMap)
HXB: HxbSit Customer (UTF8toGBK)

HXB: HxbSit Customer (CustSyncToty)
HXB: HxbSit Customer (Custmerinterface)

2022.2.7--28
HXB: HxbSit WSAdapter (connect)
HXB: HxbSit WSAdapter (sendMsg)
HXB: HxbSit WSAdapter (getAdapter)
HXB: HxbSit WSAdapter (setloaderName)
HXB: HxbSit WSAdapter (getInterfaceID)

HXB: HxbSit Service (process)
HXB: HxbSit Service (handleMessage)
HXB: HxbSit Service (getInterface)
HXB: HxbSit Service (getResult)
HXB: HxbSit Service (cDOMToString)

HXB: HxbSit Service (queryBack)
HXB: HxbSit Service (GetprofileString)
HXB: HxbSit CLog (init)
HXB: HxbSit CLog (write)
HXB: HxbSit CLog (set_timeStamp)

HXB: HxbSit CLog (getInterface)

2022.3.1--31
HXB: HxbSit Config (SUMMITUSERPWD)
HXB: HxbSit ECIFCountryMAP (ALL ECIF)
HXB: HxbSit cSyncToTY (SAVEAS)
HXB: HxbSit AdapterIDMap (SUMMITUSERPWD)
HXB: HxbSit Static_one_state_rtstd

HXB: HxbSit MAP_DEF (sMAP_DEFINITIONS)
HXB: HxbSit client_CustSyncToTY (status)
HXB: HxbSit Service (cUpdate)
HXB: HxbSit Service (sGetProfileString)
HXB: HxbSit update (libtongyeCustmerInterface2)

HXB: HxbSit Xerces (Initialize)
HXB: HxbSit Xerces (transcode)
HXB: HxbSit Xerces (release)
HXB: HxbSit Service (handlemessage)
HXB: HxbSit Service (receive)

3.21
HXB: HxbSit WSAdaper(Su_LDRMangerHandler)
HXB: HxbSit boost(replace)
HXB: HxbSit Damon(umask)
HXB: HxbSit client_CustSyncToTY(checkNamevalueLen)
HXB: HxbSit client_CustSyncToTY(checkInXmlValue)

HXB: HxbSit getinstance
HXB: HxbSit fileAdapter
HXB: HxbSit terminate
HXB: HxbSit list_files
HXB: HxbSit CSVProduct


IMPEDT

56HO总行比对环境历史数据import_extprice测试/导出。


国家开发银行苏州分行 苏州时苏州工业园东华林街2号，荣域花园南门

10/24/2021	"1. UAT环境部署技术支持：
56ho总行UAT环境跑批市场数据/零息曲线数据导入(5.20/21)"	张灿琨	黄文荣	4		
10/24/2021	"1. UAT环境部署技术支持：
56ftus自贸区UAT环境导入零息曲线数据测试/验证"	张灿琨	黄文荣	4	加班8小时	


suggested

 data2Col requiredBlock select

data2Col first requiredInput ResourceActivityName



查看使用某端口的进程
nohup /usr/local/node/bin/node /www/im/chat.js >> /usr/local/node/output.log 2>&1 &
ps -aux|grep chat.js| grep -v grep | awk '{print $2}'
lsof -i:8090
netstat -nap|grep 7779
kill -9  进程号

与系统时间不同步
vim  /etc/timezone  将内容改为 Asia/Shanghai ;  
vim /var/spool/cron/crontab/root
 添加定时任务
 11 6 * * * root ntpdate us.pool.ntp.org;hwclock -w 

trdread_tutor
subtype


subtype

TRADELIST

filter dmTRADE_FILTER

ALL
DEMOSWAP
DUX11
MMTEST
RAY1

`date +'%Y-%m-%d %H:%M:%S %s'`

1. 读取smmmit62输出文件
2. xml -> entity
	2.1 xml需要处理：
		2.1.1 mapping 62到56
		2.1.2 filter  56不需要（62传过来多余）
		2.1.3 filling 56需要（62没传）
	2.2 处理函数
		initEntiy 
		mapperEntity map字段
		reNameForRFR 填充
		lookupDataMerge 查库时候存在 ， loader 里面的 lookup 和 merge
3. entity -> 存储到数据库（insert or update）
	sEntityDoSTDAction
	静态数据(calendar, bond,definition)
	交易数据（swap， cap&floor, MM ） 分开处理
4. 配置 etc\sum2sum.cfg
   stp交互 summit\Sum2Sum

cFN_ITEMS

0可能代表的是gamma=0, sNA_DBL代表你沒有給gamma值

截图是 zero curve 从62rfr环境导出/56HO环境的数据

make_unique 

CL_StpSum2SumExport 
-upImp1sum2sum.reset()
sXMLToEntity , 我这边 添加强制转换 （char *) ,

regex_replace

測了ui的NPV, 還有會計和PLUPD, 如果一隻腳EXTERNAL, 一隻腳FLOW, 他在算net npv的時候, 會忽略external trade value

SPL_System_mktexport_
可以去spool下, 抓一下SPL_System_mktexport_MMDD_xxx.txt的檔案嗎?

#include <unistd.h> 
#include <windows.h>

SUMTOSUMCFG=D:\



无风险基准利率（RFRs） 
美国有担保隔夜融资利率（SOFR）
英镑隔夜平均指数（SONIA）
欧元短期利率（€STR）
日元无担保隔夜拆借利率（TONA）
信用风险利差是无抵押的LIBOR期限利率与有抵押的SOFR期限利率之差

SOFR	美元有担保隔夜融资利率
SONIA	英镑隔夜平均利率指数
€STR	欧元短期利率
TONA	日元无担保隔夜拆借利率
SARON	瑞士法郎隔夜参考利率
SORA	新加坡元隔夜参考利率
UK FCA	英国金融行为监管局
CME		芝加哥商品交易所
LCH		伦敦清算所
ISDA	国际掉期及衍生工具协会
ARRC	美国替换参考利率委员会
LIBOR	伦敦银行同业拆借利率

币种	现行基准利率	转换后备利率
AUD	BBSW	RBA Cash Rate
CAD	CDOR	CORRA
CHF	LIBOR	SARON
EUR	EURIBOR	€STR
EUR	LIBOR	€STR
GBP	LIBOR	SONIA 英镑隔夜银行间平均利率(SONIA)作为英镑Libor
HKD	HIBOR	HONIA
JPY	Euroyen TIBOR	TONA
JPY	LIBOR	TONA 无担保利率TONAR来取代日圆Libor
JPY	TIBOR	TONA
USD	LIBOR	SOFR

基于瑞士回购市场的抵押利率SARON
有担保隔夜融资利率SOFR（Secured Overnight Financing Rate）
伦敦银行同业拆借利率（LIBOR）作为参考利率

货币掉期业务，亦称货币互换或货币利率掉期（CCS），是指客户与银行约定在未来的一定期限内，交换两种货币约定数额的名义本金，同时根据合约中约定的两种货币的利率，定期交换对应货币名义本金的利息的交易行为。

citrix沒法讀取公司電腦目錄的, 可以試試看建一個shared的文件夾, 然後用網路磁碟機映射把他映射到E盤, 這樣在國開的citrix可以看到E盤

0  ->  sNA_DBL   代表你沒有給gamma值

RayHuang:
trade ccy放CNY, trade value放sNA_DBL
comp ccy就放asset的ccy

是用 static_import -i -xml  d:\jack\quoted.xml 导入？
-newact impedt

下次測試static_import的時候, 可以加上參數 -FIELDVAL, 它可以幫你檢查哪個字段有問題

1, location name CDBHK不存在, 我改成CDBHO  2. Cutofftime字段刪掉, 從excel裡面拿掉 3. swapposition字段要設置Y或N, 不可留空 4. PLCcy一定要填, 我填CNY 

static_import -i 1.xml -NEWACT IMLIVE -COMMIT -XML -UPDACT IMPEDT 

以下關掉Zscaler只供參考……
1.首先用cmd （run as administrator) 
2. Go to c:\program file (x86)\Zscaler 
3. Rename ZSATunnel ZSATunnelXXXX
4. 重起電腦

tibco application management 

接口9	5.6导入定盘利率（从利率汇率系统接收）
接口10	市场数据从总行/港行/自贸区5.6到RFR6.2



回购定盘利率＝∑回购价格X回购成交量/∑回购成交量X(回购天数/实际占用天数)（20170522前）
回购定盘利率＝∑当日逐笔成交价格X当日逐笔成交量/当日总成交量


已开启（running）：156.4港行环境的CDBHK-SUB服务和 156.5RFR62环境的CDBHK-PUB服务， 但是RFR62环境d:\summit\zerocurve\HKout\ 目录下的文件没有传输到156.4港行环境的d:\summit\zerocurve\in目录，当前esb服务异常？

select * from dmEXT_INST_VALUES where dmExtValueId in (select dmExtValueId from dmEXT_PRICE_VALUES WHERE Provider = 'EXTERNAL' and TradeId = '41016HO' and ValueDate = '20210310') 

黄老师：18007010662

tibco administrator   

SWAP_USDLIB

taskkill /f /im irricexport.exe /t
567254HO , 567254HO , 567256HO , 
679606HO

summit的datetime是YYYYMMDD HH:MI:SS

IRRicExport(56HO总行，市场数据请求/文件) , 取出的都是 MASTER 类别的数据，目前没有RFR，可以配置些RFR类别的数据/示例？

sGetServerDateTime()

接口8	5.6接收零息曲线
接口9	5.6导入定盘利率（从利率汇率系统接收）
接口10	市场数据从总行/港行/自贸区5.6到RFR6.2


hi 文荣，入场需要如下材料：
1）身份证正反面扫描件电子版
2）1寸蓝底的证件照电子版
3）飞思创社保缴费证明（北京社保网站可以查询下载）
4）如3）没有，需要提供公司签署的合同第一页和最后一页签字页；（请隐去敏感信息，比如工资等）
5）个人简历

用visual studio去調試這個代碼的話, sXMLToEntity的時候會有報錯, 一直按C繼續就可以, 好像是有第三方軟件的版本不一致導致內存試放有問題, 但是一直按繼續還是可以執行

10237HO(62),756540HO(56)
SWAP
CD210357 5tgb<KI* 考勤机编号：5902
CD210357(黄文荣）（密码 1qaz<KI*>）；考勤机编号：5902

10360HO,10361HO 接口6导回56
TradeRemoveTag

TEST1110+__END__

%date:~0,4%%date:~5,2%%date:~8,2%
Local date

會計規則計算出來的數字應該跟交易的 statistics 不一定對的上，交易上兩條腿的 Asset > Interest > Accrual > First/Last 如果放的是 Last (大多數 IRS 都是這個規則)，就不會跟會計一樣

要在valuetrade之前加上sSetAccrualMethod( sACCR_FIRST ); 然後取數的時候除了stats.value以外再加上stats.netasset

62里面cashflow未来的forward rate，要填到56交易的cashflow的未来forward rate，现在填到schedule里面去了，把floating端都定盘了。

floating-->asset detail-->pricing-->instrument style
10.5.90.30：8080
REFRATE 
MKTRATE

可以查MEMO or Ignore的Key words.

10.5.156.4

总行定盘利率 发送：  /home/tomcat/tibco/configuration/input
自贸区定盘 发送：  /home/tomcat/tibco/zmq/send/input

市场数据请求指令 接收 /home/tomcat/tibco/recv/output

总行 市场数据 发送： /home/tomcat/tibco/configuration/input
自贸区 市场数据 发送： /home/tomcat/tibco/zmq/send/input

麻烦问一下   测试环境利率汇率推送 SOFR、sonia  hibor  shibor  是推送到香港核心哪个环境呢？
shibor

麻烦可以提供下：各个数据文件示例，我这边开发调试下？ 谢谢


REFRATE

external price和accrual的計算你可以看d:\sumapps\client\cdbrfr\src\app\stk_tutorial\trdread_tutor.cc, 從376行開始看

select * from dmmktdata where ccy in ('USD','USD','USD','USD','USD','USD','USD', ) and dmindex in （'sofr'，） and asofdate = '20210531'  and id='rfr' 



location根據交易的company來決定, asofdate根據location的today來決定, account option根據location來決定


不同
sed -i 's/>RFR</>RFRHO</g' h1.xml

for file in `ls`;do
        echo $file
done

demofun(){
    for file in `ls $1`
    do
        if test -f $file
        then
            echo "file:  $file"
        elif test -d $file
        then
            echo "path: $file"
        fi
    done
}

path="/home/lwang/Desktop/wujuan"
demofun $path

--#!/bin/bash
string="hello,shell,haha"  
array=(${string//,/ })  
for var in ${array[@]}
do
   echo $var
done 

4. 各个56环境：总行HO, 自贸区FTUS，港行HK 是否有区别

`ls -l filename | awk '{print $5}' `
[ "$(ls -A /home/at/test/empty)" ]

md5sum RFRHO.dat >RFRHO.md5
md5sum -c RFRHO.md5
h1.xml: OK
h1.xml: FAILED
md5sum: WARNING: 1 computed checksum did NOT match
md5sum filename | awk ‘{print $1}’ #在zabbix中会提示权限不足

利率汇率系统 通过esb传给 summit系统的市场数据文件名   是 IR_FXRATE_YYMMDD.txt(自贸区资金)、IR_RATE_YYMMDD.txt(总行资金)，
利率汇率系统 通过esb传给 summit系统的定盘利率数据文件名是 REFRATE_YYMMDD.xml、INTRATE_YYMMDD.xml、ISDAFLBK_YYMMDD.xml

printf（“%ld\n”, __cplusplus);

md5sum -c --status newfile.md5  
echo $?  -->不一致返回1

awk -F ":" '{print $NF}' /etc/passwd
awk -F: 'NR==2{print "filename: "FILENAME, $0}' /etc/passwd
ifconfig |grep eth* | awk -F '[ ]+' '{print $1}'
awk '{print $NF}' h1.md5

D:\IBM\WebSphere\AppServer\profiles\AppSrv01\installedApps\bejsummit02Node01Cell\FT_Fr
ont.ear\ft.war\

insert into tabel t1 (t1.id,t1.years,t1.money) select t2.id,'2015',money from tabel t2 where t2.years = '2016' ;

LIBOR改革-20210428应用系统补丁上线部署操作方案

$[$num+$i]


a1=aa11
for var in a1 b2 c3 
do
  eval tmp=$(echo '$'"$var")
  echo $tmp
done

md5sum -c --status newfile.md5  


makecert -r -pe -n "CN=CDB560" -sv cdb_demo.pvk cdb_demo.cer
cdbsummit
makecert -r -pe -n "CN=CDB560" -sv cdb_demo.pvk cdb_demo.cer    --Succeeded

pvk2pfx.exe -pvk cdb_demo.pvk -spc cdb_demo.cer -pfx cdb_demo.pfx -pi cdbsummit

D:\IBM\WebSphere\AppServer\profiles\AppSrv01\installedApps\bejsummit02Node01Cell\FT_Fr
ont.ear\ft.war \FT_Front\ApplicationFiles
输入 mageui.exe,
Do File->New->Application Manifest

update tablename set name='aabb',pass='5566' where id=1

MktRawHo2Rfr.sh
MktRawHo2Rfr_ImpZeroCurve.sh
MktRawHo2Rfr_ImpMktRates.sh
MktRawHo2Rfr_ExpMktDate.sh
MktRawHo2Rfr_ExpIRRicExt.sh

MktRawFTUS2Rfr_ImpZeroCurve.sh
MktRawFTUS2Rfr_ImpMktRates.sh
MktRawFTUS2Rfr_ExpMktDate.sh

MktRawHk2Rfr_ImpZeroCurve.sh
MktRawHk2Rfr_ImpMktRates.sh
MktRawHkRfr_ExpMktDate.sh

ImportMktRateRFR_start.bat
ImportMktRateRFR.sh

%CLIENTPATH%\exe\flowmtmadapter.exe -INI %CLIENTPATH%\etc\FlowMTMAdapter.ini 

d：/interface/tibco/MktRate
d：/interface/tibco/Zerocurve
d：/interface/tibco/IRRICCODE
d：/interface/tibco/sum2sum


获取特定两个字符之间的内容
cut -d '=' -f 2 file | cut -d '"' -f 1

cat file | sed -n '/startup nomount/,/startup nomount/{//!p}'
cat file | sed -n '/startup nomount/,/startup nomount/{p}'  
sed删除两行之间的内容
$ cat test
1
start
2
end
3


$ sed -n '1,/start/p;/end/,$p' test
1
start
end
3


$ sed '/start/,/end/d' test
1
3

find . -iregex ".*\(\.txt\|\.pdf\)$"

find . -name "*.txt" -o -name "*.pdf" 
find . \( -name "*.txt" -o -name "*.pdf" \)

遍历当前文件夹及子文件夹 For /D %i In (*) Do Echo %i
BAT版 For /D %%i In (*) Do Echo %%i

For /D %i In (C:\*) Do Echo %i

for /f "delims==" %a in ('dir /b /s C:\Users\Administrator\Desktop\测试\*.pdf')do copy /-y "%a" C:\Users\Administrator\Desktop\copy

for /f "delims==" %%a in ('dir /b /s  *.cc'） do wc -l

pause

"C:\Program Files (x86)\Java\jdk1.8.0_291\bin\javac.exe" 

"C:\Program Files\Java\jdk1.8.0_291\bin\javac.exe"
set path=%path%;C:\Program Files\Java\jdk1.8.0_291\bin;

set JAVA_TOOL_OPTIONS=-Dfile.encoding=UTF-8
javac -encoding utf-8 Puppy.java && java Puppy

javac -encoding utf-8 Puppy.java

"C:\Program Files\Java\jdk1.8.0_291\bin\javac.exe"

C:\Users\u726334\AppData\Roaming\Code\User\settings.json
C:\notes\java\.vscode\launch.json
C:\notes\.vscode\launch.json

对于Java由于默认的编码方式是 UNICODE,所以用中文也易出问题,常见的解决是
String s2 = new String(s1.getBytes(“ISO-8859-1”),”GBK”);


chcp 936
save encoding gbk2312
javac -encoding gbk Puppy.java

chcp 936  65001  
437 asii
936 gbk2312
gbk2312


$workspaceRoot
$dir
$dirWithoutTrailingSlash
$fullFileName
$fileName
$fileNameWithoutExt

Singapore1
bios.forceSetupOnce = "TRUE"

tools.syncTime = "FALSE"
time.synchronize.continue = "FALSE"
time.synchronize.restore = "FALSE"
time.synchronize.resume.disk = "FALSE"
time.synchronize.shrink = "FALSE"
time.synchronize.tools.startup = "FALSE"
time.synchronize.tools.enable = "FALSE"
time.synchronize.resume.host = "FALSE" 

customer->Comment1.Text


retVal = sEntityDBWrite( tTblEnt, _tTable, 00 );

   if (sEntityDBWrite(Entity, Data, 00) == sSUCCESS)
   {
      // if do not want to commit - rollback; else commit
      Commit == sYES ? sSybEndTran(proc, tran) : sSybRollBack();
      return sSUCCESS;
   }

15号线最后一站俸伯附近的前俸伯村 每月也只要1000元左右
租金1500元以内，有独立卧室、独立卫生间，房东直租。满足这些条件的房子，大多是城中村，1号线四惠东的康家沟村，1号线双桥的东柳村，6号线草房的皮村，以及地铁最后一站的农村自建房，例如天通苑北附近的东三旗村、半截塔村，俸伯的前俸伯村、后俸伯村，以及北安河的草场村等。

extprice

cdb_extpriceimp -X 04/01/2004 -Y 08/01/2004 -F ALL -C NYC -M EXP -UPDATE -D -O d:/ALL_20040801.xml

Pai@314159
Pai#314159
Pai314!159
Pai@314!159

#include<windows.h>
Sleep(20*1000);


pai@314159
Pai31!4159
涨幅

基本面选股:
AA:=DYNAINFO(39)>0 AND DYNAINFO(39)<200;{0<市盈率<200}
BB:=FINANCE(20)>5000 AND FINANCE(21)/FINANCE(20)>0.2;{主营业务利润率>0.2}
CC:=FINANCE(34)>0 AND CLOSE/FINANCE(34)<80;{市净率}
DD:=FINANCE(29)>0 AND FINANCE(30)/FINANCE(19)>0.08;{净资产收益率大于8％}
EE:=FINANCE(1)*C/FINANCE(20)>0 AND FINANCE(1)*C/FINANCE(20)<12;{市销率取值小于12}

小蜜蜂远程办公网
云队友
电鸭社区
云工
圆领
boss直聘
前程

Copilot

上海咪露咪露软件有限公司  印伟 徐放蕾 

量化交易系统开发项目经理

区块链挖矿系统，dapp小游戏，量化交易系统，合约、代币、跟单交易系统，可成型，可定制，源码交付，多年系统开发经验

数据获取、回测框架搭建、仿真搭建、实盘通道、如果面向市场的话还要设计ui界面

恒生、铭创、同花顺罚款约4.5亿

1、选择分钟线 金叉死叉处理开空开多 判断是否补仓和开仓
2、合约仿瀑布机制，监测行情当前分钟线的针对于开盘价比例达到多少时 停止补仓
3、现货防滑跌机制，监测行情当前分钟线的针对于开盘价比例达到多少时 停止补仓
4、趋势做单，根据大行情 判断是否补仓
5、防爆仓机制： 设置止损比例 当全仓补完后达到止损比例后 平仓将损失降到最低，有的客户会要求判断是否有反向的单子，如果没有则自动开启
6、区间做单：设置高价和低价 只在该价格内进行补单或者开单
7、点位做单:设置一个价格，只在该价格上下进行开单



------------------------------

## 20210906 Mon

CDB: RefRateCopy: 56HK RefRate restore

岗位职责：
1、参与量化投资体系研究，建立量化模型及测试工作；
2、量化投资组合的日常管理及风险控制；
3、参与相关量化产品的设计及路演工作；
4、参与国信TS软件开发及客户相关交易服务。
任职资格：
1、***硕士及以上学历，数理统计类、金融工程类相关专业；
2、2年以上券商、基金等量化投资研究方面的工作经验，具有过往可追溯的投资交易记录且业绩良好及具有渠道客户资源者优先；
3、掌握扎实的数理统计及金融工程知识，熟悉股票、期货、期权等市场及各类金融产品，具有较强的创新能力。
岗位职责：
量化开发员，负责量化交易平台的研发、风控系统的设计和维护。包括股票、期货、期权等交易系统的研发、优化。
岗位要求：
1.计算机相关专业本科以上学历，或同等计算机能力者。
2.非常扎实的C/C++语言编程、调试的知识、经验和技能，有良好的编程习惯。
3.对数据结构和算法设计具有深刻的理解，有复杂系统的分析和设计经验。
4.具备优秀的逻辑思维能力，对解决挑战性问题充满热情，善于分析解决问题。
5.有强烈的上进心和求知欲，善于学习新事物。
6.深入理解 Linux 系统开发环境，包括系统编程、网络编程、工具链、 Shell 命令和 Shell 脚本编程等。
7.熟悉体系结构和操作系统原理。 （加分项）
8.开源社区的活跃参与者，有功能性patch贡献者尤佳。 （加分项）
工作职责：
1、与信托公司、证券公司对接资产管理平台、量化投资交易等系统个性化需求沟通处理，优化系统功能；
2、负责项目进度的各流程节点的时间把控与人员协调；
3、个性化资产管理需求沟通处理，优化系统功能；
4、管理开发团队项目进度。
任职资格：
1、有过信托公司技术项目管理经验者优先，或银行资管系统项目管理经验优先；
2、掌握Java编程技术，熟悉spring+mybatis等框架；
3、具备良好的沟通协调能力，责任心强；
4、加分项：pmp、Java web编程经验；金融机构资管系统项目管理经验；
岗位职责：
1.带领团队完成技术选型、搭建量化投资策略回测分析系统；
2.协助完成金融衍生因子数据库建设、升级、维护及接口服务体系；
3.结合业务需求，协助完成产品工程化开发工作，支持业务业绩提升。
任职要求：
1.硕士以上学历，数学、统计、金融工程、计算机、数学等相关专业，有证券、基金从业资格；
2.具有4年以上专注量化投资领域系统开发及维护工作，熟知多种系统框架；
3.具有成熟的、可快速落地的系统开发成果；
4.可以独立完成基于java、Python的量化投资系统开发项目；
5.有强烈的责任心、学习能力强、对量化交易技术研究有极高的兴趣，有实盘投资经验优先；
6.对机器学习、深度学习等算法有深度研究者可优先考虑。

岗位职责:
1、设计、完善期货、期权等交易平台架构及基本函数设计;
2、能够根据策略师的策略开发稳定，契合的自动交易系统；
3、根据业务需求完成其他软件应用的开发；
4、负责交易平台接口和相关数据库的构建、维护。
任职要求:
1、计算机科学与技术、软件工程等相关专业硕士及以上学历；
2、3年以上系统程序开发经验，1年以上程序化交易系统开发经验；
3、至少熟悉一种量化框架开发；
4、有期货、证券等相关金融系统开发经验者优先；
5、熟悉常用存储系统:MySQL、MongoDB、Redis等；
6、至少熟练运用一种以上编程语言：C/C++，python，java。


------------------------------


## 20210907 Tue

CDB: RefRateCopy: 56FTUS RefRate restore

三.开发前思考
1.计算机-金融-数学，知识比重为1-3-6
2.用java还是python写都可以，架构方面没太大区别，java的interface用python的abc库一样可以实现。但是java的库比较少
3.对于CTA交易，策略最重要，性能、代码不太重要。高频交易，性能比较重要.策略需要集中信号管理型和资金管理型的优点.
4.经典的策略，比如Hans123和海龟交易法则及其优化方式，需要非常熟悉
5.机器学习只是锦上添花，可以不考虑。
6.实盘交易盈利的策略实现程序化才有价值.
7.没有经历过几次爆仓的交易员是成长不起来的.
8.谨记三条:第一,及时止损;第二,资金仓位管理;第三,纪律最重要,心态就是纪律.
9.回测必须覆盖单边上涨,单边下跌,区间震荡三种走势
10.策略在实盘使用前最好找历史上和期货的最近几天走势类似的回测下
四.开发后思考
1.回测框架怎么设计，兼容不同的第三方数据来源，不同的策略回测，下单交易引擎，不同的第三方实盘交易所，不同的数据存储方式
2.回测框架需要考虑稳定，已读，扩展性。
3.均线，海龟，多周期，多种指标信号，布林海盗系统，各种策略最好都回测一遍，熟悉内部实现。
4.交易前需要判断当前是趋势还是震荡盘，趋势需要追涨杀跌，盘整盘做高抛低吸，策略正好相反。
5.趋势盘是容易程序量化抓住的。盘整盘怎么做，比趋势难把握。
6.选择合适的交易周期，1分钟线会频繁的交易，虽然大部分交易是盈利的，但是高昂的手续费会吞噬掉盈利，三分钟
或者长一点的周期，根据交易品种判断，不是一致的。
7.根据哪种指标做动态止盈，绝对值还是，均线，kd，需要考虑。
8.资金管理根据技术信号做，还是固定手数，差别挺大的。建议固定手数。
9.回测是否覆盖了牛市，熊市，猴市。大的震荡，小的震荡。
10.同一时间，多个指标发出买入信号，是否同时加仓，控制加仓过快的问题。
11.最麻烦的，回测数据来源的问题。RQData，JQData，Wind，还是EMQuantApi,数据的质量，脏数据是很头疼的问题。
12.交易系统和券商交易软件计算出来的指标值不同，需要手动算下是数据的问题，还是计算方式，周期不同的问题。
13.语言是用java，c++，还是python，R，。大部分量化平台的接口,策略会给python，c++的接口，建议二选一。
14.做CTA，Alpha选股还是套利,高频，需要一步步升级打怪，从易到难.
量化交易至少应该包括五个方面的要素:
(1)买入和卖出的信号系统。
(2)牛市还是熊市的方向指引
(3)头寸管理以及资金管理。
(4)风险控制，运用信号源来确定止损位置，利用资产曲线和权益曲线来加以判定和管理。
(5)投资组合，不一样的投资品种、不相同的交易系统(不同功能和参数，有快有慢)以及不相同时间周期组合.，现分散组合，让交易账户波动更加稳定。


------------------------------



## 20210908 Web

CDB: flowmtmadapter: same & last id 

Problem
=======

考虑某一股票的价格P，每过一段时间我们能获得一对数(t, Pt)，分别为当前的时间戳t和当前该股票的价格Pt，需要计算该股票在[t-W, t]时间段内的平均价格，
其中W是事先给定的窗口大小，单位和t相同。

请编写程序来实现这个计算过程。接口参见以下Interface节。

算法需要满足以下要求：

1. 相邻数据点之间的间隔不固定，可能有较大变化，在计算的时候应考虑数据间隔变化极端的情况下的鲁棒性;
2. 计算的平均价格应能较好反映股票价格在窗口时间内的“平均水平”
3. 假设在相邻两次数据到达期间内，股票的真实价格都等于前一次数据的价格
4. 所谓平均水平指的是股票价格在窗口内的简单移动平均（SMA）而不是指数移动平均（EMA）
5. 可用的内存大小是有限的，为O(num_bin)规模，当窗口内到达的数据量超过可用的存储空间时，应做一定的取舍，既不突破内存限制，又尽可能保证结果的精确性（只是简单地把尾部数据删除是不行的）
6. 实现以下MovingAverage接口
7. 尽量使用性能较优的算法和实现方法

编程语言: Python / C++

Note
====

num_bin: 使用的内存大小应为O(num_bin)级别
window：移动平均的窗口长度

timestamp是时间戳，浮点数，数据间隔不固定，可能一秒来几十个数据，也可能几小时来一个数据


Interface
=========

（以python为例）
class MovingAverage:
    def __init__(self, num_bin: int, window: float):
        pass

    def Get(self) -> float:
        "返回当前计算的平均值"
        raise NotImplementedError
        
    def Update(self, timestamp: float, value: float):
        "新数据到达，更新状态"
        raise NotImplementedError

每次数据到达时，会依次调用Update和Get方法


------------------------------


## 20210909 Thu

CDB: cdbEodbetch_archive: import ISBLACK

------------------------------



## 20210910 Fri

CDB: index volatility : 56HO export commset

------------------------------

## 20210911 Sat



------------------------------


## 20210912 Sun



------------------------------


## 20210913 Mon

CDB: 56FTZ export static_data

------------------------------


## 20210914 Tue

CDB: 56FTZ UAT develop doc


------------------------------



## 20210915 Web

CDB: 56FTZ UAT FT_FRONT install pack 


------------------------------


## 20210916 Thu

CDB: 56FTZ UAT complice libstkrtdata

------------------------------



## 20210917 Fri

CDB: 56HO execute cpcurve/extprice


------------------------------

## 20210918 Sat

CDB: 56FTZ import market data 


------------------------------


## 20210919 Sun




------------------------------


## 20210920 Mon



------------------------------


## 20210921 Tue

CDB: 56HO export history extprice(import_extprice)

------------------------------



## 20210922 Web

CDB: update shell(import data) 

------------------------------


## 20210923 Thu

CDB: UAT test data format

------------------------------



## 20210924 Fri

CDB: UAT support(import intrate)

------------------------------

## 20210925 Sat



------------------------------


## 20210926 Sun

CDB: UAT62 support(import libor_rate)

------------------------------

## 20210927 Mon

CDB: UAT56 support(import zerocurve EODRISK/EODREVAL)

------------------------------


## 20210928 Tue

CDB: UAT56 support(export mktdate asofdate)

------------------------------



## 20210929 Web

CDB: UAT56 support(flowmtmadapter_start)

------------------------------


## 20210930 Thu

CDB: UAT56 support(impmktrates_start)

------------------------------


# 202110 


------------------------------


## 20211001 Fri



------------------------------

## 20211002 Sat

%systemroot%\Microsoft.Net\Framework

------------------------------


## 20211003 Sun



------------------------------



## 20211004 Mon



------------------------------


## 20211005 TUE



------------------------------


## 20211006 Wed



------------------------------


## 20211007 Thu


国庆

------------------------------


## 20211008 Fri


CDB: UAT 56HO Test mktexp 

------------------------------


## 20211009 Sat

CDB: UAT 56 index analysis

------------------------------


## 20211010 Sun

------------------------------


CDB: UAT 56FTZ Import/Export Mktdate


## 20211011 Mon

CDB: UAT 56FTZ Test REUTERA data

------------------------------


## 20211012 TUE

CDB: UAT 56FTZ EodBatch Day Test Mktdate

------------------------------


## 20211013 Wed


CDB: UAT 56HO EodBatch Day Test Mktdate

------------------------------


## 20211014 Thu

CDB: UAT 56HK EodBatch Day Test Mktdate

------------------------------


## 20211015 Fri


CDB: DEV 56FTZ Import/Export Mktdate

------------------------------


## 20211016 Sat

CDB: DEV 56HO Import/Export Mktdate

------------------------------


## 20211017 Sun

CDB: UAT2 56HK Import/Export Mktdate


## 20211018 Mon

CDB: UAT 56FTZ cpcuver compile

------------------------------


## 20211019 TUE



------------------------------


## 20211020 Wed



------------------------------


## 20211021 Thu



------------------------------


## 20211022 Fri



------------------------------


## 20211023 Sat



------------------------------


## 20211024 Sun


------------------------------


## 20211254 Mon



------------------------------


## 20211026 TUE



------------------------------


## 20211027 Wed



------------------------------


## 20211028 Thu



------------------------------


## 20211029 Fri



------------------------------


## 20211030 Sat



------------------------------


## 20211031 Sun


------------------------------

# 202111



## 20211101 Mon



------------------------------


## 20211102 TUE



------------------------------


## 20211103 Wed



------------------------------


## 20211104 Thu



------------------------------


## 20211105 Fri



------------------------------


## 20211106 Sat



------------------------------


## 20211107 Sun





